<<<<<<< HEAD
var GUI={DBentry:['','',''],DBupdate:0,activePlayer:'',browsemode:'file',checkvol:0,currentDBpos:[0,0,0,0,0,0,0,0,0,0,0],currentDBpath:['','','','','','','','','','',''],currentalbum:null,currentknob:null,currentpath:'',currentsong:null,json:0,libraryhome:'',forceGUIupdate:false,maxvol:100,minvol:0,mode:'websocket',noticeUI:{},playlist:null,plugin:'',state:'',old_state:'none',stepVolumeDelta:0,stepVolumeInt:0,stream:'',visibility:'visible',vol_changed_local:0,volume:null,clientUUID:null};function generateUUID(){var d=new Date().getTime();var uuid='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=='x'?r:(r&0x3|0x8)).toString(16);});return uuid;};function sendCmd(inputcmd){$.ajax({type:'GET',url:'/command/?cmd='+inputcmd+'&clientUUID='+GUI.clientUUID,cache:false});}
function checkWebSocket(){if(window.WebSocket){return'websocket';}else{return'longpolling';}}
function checkWorkers(){if((window.Worker&&window.Blob)||(Modernizr.webworkers&&Modernizr.blobconstructor)){return true;}else{return false;}}
function parsePath(str){var cutpos=str&&str.length?str.lastIndexOf('/'):0;var songpath='';if(cutpos&&cutpos!==-1){songpath=str.slice(0,cutpos);}
return songpath;}
var idleTime=0;var viewScreenSaver=0;var widthScreenSaver=0;var isLocalHost=0;var SStime=-1;$(document).ready(function(){GUI.clientUUID=generateUUID();if($('#section-index').length){if(location.hostname==="localhost"||location.hostname==="127.0.0.1"){isLocalHost=1;SStime=localSStime;}else{isLocalHost=0;SStime=remoteSStime;}
if(SStime>=0){var idleInterval=setInterval(timerIncrement,1000);}
$(this).on("mousemove click keypress",function(e){idleTime=0;if(viewScreenSaver){$('.tab-content').show("slow");if((smallScreenSaver)&&(isLocalHost)){$('.small-screen-saver-content').hide("slow");}else{$('.screen-saver-content').hide("slow");}
$('#menu-bottom').show("slow");$('#menu-top').show("slow");viewScreenSaver=0;}});}});function timerIncrement(){if($('#section-index').length&&GUI.state==='play'&&!$('#panel-sx').hasClass('active')&&!$('#panel-dx').hasClass('active')){idleTime=idleTime+1;}else{idleTime=0;}
if(idleTime>SStime){removePlayerScrollbars();$('.tab-content').hide("slow");if((smallScreenSaver)&&(isLocalHost)){$('.small-screen-saver-content').show("slow");}else{$('.screen-saver-content').show("slow");}
$('#menu-bottom').hide("slow");$('#menu-top').hide("slow");viewScreenSaver=1;}}
function checkPlayerState(){if($('#playback').hasClass('active')){removePlayerScrollbars();}else{addPlayerScrollbars();}}
function removePlayerScrollbars(){$('html').addClass('disable-scrollbar-0');$('#section-index').addClass('disable-scrollbar-1');$('#section-index').addClass('disable-scrollbar-2');}
function addPlayerScrollbars(){$('html').removeClass('disable-scrollbar-0');$('#section-index').removeClass('disable-scrollbar-1');$('#section-index').removeClass('disable-scrollbar-2');}
function refreshTimer(startFrom,stopTo,state){var display=$('#countdown-display');display.countdown('destroy');display.countdown({since:((state!=='stop'||state!==undefined)?-(startFrom):0),compact:true,format:'MS'});if(state!=='play'){display.countdown('pause');}
var displayss=$('#countdown-display-ss');displayss.countdown('destroy');displayss.countdown({since:((state!=='stop'||state!==undefined)?-(startFrom):0),compact:true,format:'MS'});if(state!=='play'){displayss.countdown('pause');}
var displaysss=$('#countdown-display-sss');displaysss.countdown('destroy');displaysss.countdown({since:((state!=='stop'||state!==undefined)?-(startFrom):0),compact:true,format:'MS'});if(state!=='play'){displaysss.countdown('pause');}}
function refreshKnob(){window.clearInterval(GUI.currentKnob);var initTime=parseInt(GUI.json.song_percent)*10;var delta=parseInt(GUI.json.time);var step=parseInt(1000/delta);var time=$('#time');time.val(initTime,false).trigger('update');if(GUI.state==='play'){GUI.currentKnob=setInterval(function(){initTime=initTime+((GUI.visibility!=='visible')?step:1);time.val(initTime,false).trigger('update');},delta);}}
function timeConvert(seconds){var minutes=Math.floor(seconds/60);seconds-=minutes*60;var mm=(minutes<10)?('0'+minutes):minutes;var ss=(seconds<10)?('0'+seconds):seconds;return mm+':'+ss;}
function timeConvert2(ss){var hr=Math.floor(ss/3600);var mm=Math.floor((ss-(hr*3600))/60);ss=Math.floor(ss-(hr*3600)-(mm*60));if(hr>0){if(hr<10){hr='0'+hr;}
hr+=':';}else{hr='';}
if(mm<10){mm='0'+mm;}
if(ss<10){ss='0'+ss;}
return hr+mm+':'+ss;}
function timeConvert3(ss){var hr=Math.floor(ss/3600);var mm=Math.floor((ss-(hr*3600))/60);ss=Math.floor(ss-(hr*3600)-(mm*60));if(hr>0){if(hr<10){hr='0'+hr+'h ';}
hr+='h ';}else{hr='';}
if(mm<10){mm='0'+mm;}
if(ss<10){ss='0'+ss;}
return hr+mm+'m '+ss+'s';}
function countdownRestart(startFrom){var display=$('#countdown-display').countdown('destroy');display.countdown({since:-(startFrom),compact:true,format:'MS'});var displayss=$('#countdown-display-ss').countdown('destroy');displayss.countdown({since:-(startFrom),compact:true,format:'MS'});var displaysss=$('#countdown-display-sss').countdown('destroy');displaysss.countdown({since:-(startFrom),compact:true,format:'MS'});}
function reset_vol_changed_local(){GUI.vol_changed_local=0;}
function setvol(val){GUI.volume=val;$('#volumemute').removeClass('btn-primary');sendCmd('setvol '+val);if(GUI.vol_changed_local===0){setInterval(reset_vol_changed_local,5000);GUI.vol_changed_local=1;}}
function volumeStepCalc(direction){var i=0;var way=direction;GUI.volume=parseInt($('#volume').val());var volumeStep=function volumeStepCycle(way){i++;if(direction==='up'){GUI.stepVolumeDelta=parseInt(GUI.volume)+i;}else if(direction==='dn'){GUI.stepVolumeDelta=parseInt(GUI.volume)-i;}
$('#volume').val(GUI.stepVolumeDelta).trigger('change');};volumeStep();GUI.stepVolumeInt=window.setInterval(function(){volumeStep();},200);}
function volumeStepSet(){window.clearInterval(GUI.stepVolumeInt);setvol(GUI.stepVolumeDelta);}
function customScroll(list,destination,speed){if(typeof(speed)==='undefined'){speed=500;}
var entryheight=49;var centerheight=parseInt($(window).height()/2);var scrolltop=$(window).scrollTop();var scrollcalc=0;var scrolloffset=0;if(list==='db'){scrollcalc=parseInt((destination)*entryheight-centerheight);scrolloffset=scrollcalc;}else if(list==='pl'){scrollcalc=parseInt((destination+2)*entryheight-centerheight);scrolloffset=Math.abs(scrollcalc-scrolltop);scrolloffset=(scrollcalc>scrolltop?'+':'-')+'='+scrolloffset+'px';$('#playlist-entries').find('li').eq(destination).addClass('active');}
$.scrollTo((scrollcalc>0?scrolloffset:0),speed);}
function randomScrollPL(){var n=$('.playlist li').size();var random=1+Math.floor(Math.random()*n);customScroll('pl',random);}
function randomScrollDB(){var n=$('.database li').size();var random=1+Math.floor(Math.random()*n);customScroll('db',random);}
function toggleLoader(action){if(action==='close'){$('#loader').addClass('hide');}else{if($('#section-dev').length){$('#loader').addClass('hide');new PNotify({title:'Warning',text:'The loading layer (spinning arrows) points to a socket error',icon:'fa fa-exclamation-circle'});}else{$('#loader').removeClass('hide');}}}
function customNotify(notify){if(notify.custom==='kernelswitch'){if(GUI.noticeUI.kernelswitch!==undefined){GUI.noticeUI.kernelswitch.remove();}
GUI.noticeUI.kernelswitch=new PNotify({title:('title'in notify)?notify.title:'[missing title]',text:('text'in notify)?notify.text:'[missing text]',icon:'fa fa-refresh',hide:false,confirm:{confirm:true,buttons:[{text:notify.btntext,addClass:'btn-default btn-block  uppercase',click:function(){$.post('/settings/',{'syscmd':'reboot'});toggleLoader();}},{text:'Cancel',addClass:'hide'}]},buttons:{closer:false,sticker:false}});}}
function renderMSG(text){var notify=text[0];if('custom'in notify&&notify.custom!==null){customNotify(notify);return;}
var noticeOptions={title:('title'in notify)?notify.title:'[missing title]',text:('text'in notify)?notify.text:'[missing text]',icon:(notify.icon===undefined)?'fa fa-check':notify.icon,opacity:(notify.opacity===undefined)?0.9:notify.opacity,hide:(notify.hide===undefined&&notify.permanotice===undefined),buttons:{closer:(notify.permanotice===undefined),sticker:(notify.permanotice===undefined)},delay:(notify.delay===undefined)?8000:notify.delay,mouse_reset:false};if('permanotice'in notify){if(GUI.noticeUI[notify.permanotice]===undefined){GUI.noticeUI[notify.permanotice]=new PNotify(noticeOptions);}else{if('permaremove'in notify){GUI.noticeUI[notify.permanotice].remove();GUI.noticeUI[notify.permanotice]=undefined;}else{GUI.noticeUI[notify.permanotice].open();}}}else{new PNotify(noticeOptions);}}
function sortOrder(id){var pos=$('#'+id).index();id=parseInt(id.replace('pl-',''));sendCmd('moveid '+id+' '+pos);}
function loadingSpinner(section,hide){if(hide==='hide'){if(section==='db'){$('#spinner-db').addClass('hide');}
if(section==='pl'){$('#spinner-pl').addClass('hide');}}else{if(section==='db'){$('#spinner-db').removeClass('hide');}
if(section==='pl'){$('#spinner-pl').removeClass('hide');}}}
function setPlaybackSource(){var activePlayer=GUI.libraryhome.ActivePlayer;$('#overlay-playsource-open button').text(activePlayer);$('#overlay-playsource a').addClass('inactive');var source=activePlayer.toLowerCase();$('#playsource-'+source).removeClass('inactive');if(activePlayer==='Spotify'||activePlayer==='Airplay'||activePlayer==='SpotifyConnect'){$('#volume').trigger('configure',{'readOnly':true,'fgColor':'#1A242F'}).css({'color':'#1A242F'});$('#volume-knob').addClass('nomixer');$('#volume-knob button').prop('disabled',true);$('#single').addClass('disabled');}else{$('#volume').trigger('configure',{'readOnly':false,'fgColor':'#0095D8'}).css({'color':'#0095D8'});$('#volume-knob').removeClass('nomixer');$('#volume-knob button').prop('disabled',false);$('#single').removeClass('disabled');}
$('#playlist-entries').removeClass(function(index,css){return(css.match(/(^|\s)playlist-\S+/g)||[]).join(' ');}).addClass('playlist-'+source);$('#pl-manage').removeClass(function(index,css){return(css.match(/(^|\s)pl-manage-\S+/g)||[]).join(' ');}).addClass('pl-manage-'+source);}
function chkKey(key){return(key!==undefined&&key!=='');}
function renderLibraryHome(){loadingSpinner('db');$('#database-entries').addClass('hide');$('#db-level-up').addClass('hide');$('#db-homeSetup').removeClass('hide').removeClass('btn-primary').addClass('btn-default');$('#home-blocks').removeClass('hide');var obj=GUI.libraryhome,i=0,content='',divOpen='<div class="col-lg-3 col-md-4 col-sm-6">',divClose='</div>',toggleMPD='',toggleSpotify='',notMPD=(obj.ActivePlayer==='Spotify'||obj.ActivePlayer==='Airplay');if(isLocalHost){content='';}else{content='<div class="col-sm-12"><h1 class="txtmid">Browse your library</h1></div>';}
setPlaybackSource();if(notMPD){toggleMPD=' inactive';}
for(i=0;(bookmark=obj.bookmarks[i]);i+=1){content+=divOpen+'<div id="home-bookmark-'+bookmark.id+'" class="home-block home-bookmark'+toggleMPD+'" data-path="'+bookmark.path+'"><i class="fa fa-star"></i><h3>'+bookmark.name+'</h3>bookmark</div>'+divClose;}
if(chkKey(obj.networkMounts)){if(isLocalHost){if(obj.networkMounts===0){if(notMPD){content+=divOpen+'<div id="home-nas" class="home-block inactive"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3></div>'+divClose;}else{content+=divOpen+'<a class="home-block'+toggleMPD+'" href="/sources/add/"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3></a>'+divClose;}}else{content+=divOpen+'<div id="home-nas" class="home-block'+toggleMPD+'" data-path="NAS"><i class="fa fa-sitemap"></i><h3>Network mounts ('+obj.networkMounts+')</h3></div>'+divClose;}}else{if(obj.networkMounts===0){if(notMPD){content+=divOpen+'<div id="home-nas" class="home-block inactive"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3>network attached storages</div>'+divClose;}else{content+=divOpen+'<a class="home-block'+toggleMPD+'" href="/sources/add/"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3>click to add some</a>'+divClose;}}else{content+=divOpen+'<div id="home-nas" class="home-block'+toggleMPD+'" data-path="NAS"><i class="fa fa-sitemap"></i><h3>Network mounts ('+obj.networkMounts+')</h3>network attached storages</div>'+divClose;}}}
if(chkKey(obj.localStorages)){if(isLocalHost){if(obj.localStorages===0){content+='';}else{content+=divOpen+'<div id="home-local" class="home-block'+toggleMPD+'" data-path="LocalStorage"><i class="fa fa-hdd-o"></i><h3>LocalStorage ('+obj.localStorages+')</h3></div>'+divClose;}}else{if(obj.localStorages===0){content+='';}else{content+=divOpen+'<div id="home-local" class="home-block'+toggleMPD+'" data-path="LocalStorage"><i class="fa fa-hdd-o"></i><h3>LocalStorage ('+obj.localStorages+')</h3>locally stored music</div>'+divClose;}}}
if(chkKey(obj.USBMounts)){if(isLocalHost){if(obj.USBMounts===0){if(notMPD){content+=divOpen+'<div id="home-usb" class="home-block inactive"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3></div>'+divClose;}else{content+=divOpen+'<a id="home-usb" class="home-block'+toggleMPD+'" href="/sources"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3></a>'+divClose;}}else{content+=divOpen+'<div id="home-usb" class="home-block'+toggleMPD+'" data-path="USB"><i class="fa fa-hdd-o"></i><h3>USB storage ('+obj.USBMounts+')</h3></div>'+divClose;}}else{if(obj.USBMounts===0){if(notMPD){content+=divOpen+'<div id="home-usb" class="home-block inactive"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3>no USB storage plugged</div>'+divClose;}else{content+=divOpen+'<a id="home-usb" class="home-block'+toggleMPD+'" href="/sources"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3>no USB storage plugged</a>'+divClose;}}else{content+=divOpen+'<div id="home-usb" class="home-block'+toggleMPD+'" data-path="USB"><i class="fa fa-hdd-o"></i><h3>USB storage ('+obj.USBMounts+')</h3>USB attached drives</div>'+divClose;}}}
if(chkKey(obj.webradio)){if(isLocalHost){if(obj.webradio===0){if(notMPD){content+=divOpen+'<div id="home-webradio" class="home-block inactive"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3></div>'+divClose;}else{content+=divOpen+'<a id="home-webradio" class="home-block'+toggleMPD+'" href="#" data-toggle="modal" data-target="#modal-webradio-add"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3></a>'+divClose;}}else{content+=divOpen+'<div id="home-webradio" class="home-block'+toggleMPD+'" data-path="Webradio"><i class="fa fa-microphone"></i><h3>My Webradios ('+obj.webradio+')</h3></div>'+divClose;}}else{if(obj.webradio===0){if(notMPD){content+=divOpen+'<div id="home-webradio" class="home-block inactive"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3>webradio local playlists</div>'+divClose;}else{content+=divOpen+'<a id="home-webradio" class="home-block'+toggleMPD+'" href="#" data-toggle="modal" data-target="#modal-webradio-add"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3>click to add some</a>'+divClose;}}else{content+=divOpen+'<div id="home-webradio" class="home-block'+toggleMPD+'" data-path="Webradio"><i class="fa fa-microphone"></i><h3>My Webradios ('+obj.webradio+')</h3>webradio local playlists</div>'+divClose;}}}
if(isLocalHost){content+=divOpen+'<div id="home-albums" class="home-block'+toggleMPD+'" data-path="Albums" data-browsemode="album"><i class="fa fa-dot-circle-o"></i><h3>Albums</h3></div>'+divClose;}else{content+=divOpen+'<div id="home-albums" class="home-block'+toggleMPD+'" data-path="Albums" data-browsemode="album"><i class="fa fa-dot-circle-o"></i><h3>Albums</h3>browse MPD database by album</div>'+divClose;}
if(isLocalHost){content+=divOpen+'<div id="home-artists" class="home-block'+toggleMPD+'" data-path="Artists" data-browsemode="artist"><i class="fa fa-users"></i><h3>Artists</h3></div>'+divClose;}else{content+=divOpen+'<div id="home-artists" class="home-block'+toggleMPD+'" data-path="Artists" data-browsemode="artist"><i class="fa fa-users"></i><h3>Artists</h3>browse MPD database by artist</div>'+divClose;}
if(isLocalHost){content+=divOpen+'<div id="home-composer" class="home-block'+toggleMPD+'" data-path="Composer" data-browsemode="composer"><i class="fa fa-users"></i><h3>Composer</h3></div>'+divClose;}else{content+=divOpen+'<div id="home-composer" class="home-block'+toggleMPD+'" data-path="Composer" data-browsemode="composer"><i class="fa fa-users"></i><h3>Composer</h3>browse MPD database by composer</div>'+divClose;}
if(isLocalHost){content+=divOpen+'<div id="home-genre" class="home-block'+toggleMPD+'" data-path="Genres" data-browsemode="genre"><i class="fa fa-tags"></i><h3>Genres</h3></div>'+divClose;}else{content+=divOpen+'<div id="home-genre" class="home-block'+toggleMPD+'" data-path="Genres" data-browsemode="genre"><i class="fa fa-tags"></i><h3>Genres</h3>browse MPD database by genre</div>'+divClose;}
if(chkKey(obj.Spotify)){if(isLocalHost){if(obj.Spotify==='0'){}else{if(obj.ActivePlayer!=='Spotify'){content+=divOpen+'<div id="home-spotify-switch" class="home-block"><i class="fa fa-spotify"></i><h3>Spotify</h3></div>'+divClose;}else{content+=divOpen+'<div id="home-spotify" class="home-block'+toggleSpotify+'" data-plugin="Spotify" data-path="Spotify"><i class="fa fa-spotify"></i><h3>Spotify</div>'+divClose;}}}else{if(obj.Spotify==='0'){}else{if(obj.ActivePlayer!=='Spotify'){content+=divOpen+'<div id="home-spotify-switch" class="home-block"><i class="fa fa-spotify"></i><h3>Spotify</h3>click to switch renderer</div>'+divClose;}else{content+=divOpen+'<div id="home-spotify" class="home-block'+toggleSpotify+'" data-plugin="Spotify" data-path="Spotify"><i class="fa fa-spotify"></i><h3>Spotify</h3>music for everyone</div>'+divClose;}}}}
if(chkKey(obj.Dirble)){if(isLocalHost){content+=divOpen+'<div id="home-dirble" class="home-block'+toggleMPD+'" data-plugin="Dirble" data-path="Dirble"><i class="fa fa-globe"></i><h3>Dirble</h3></div>'+divClose;}else{content+=divOpen+'<div id="home-dirble" class="home-block'+toggleMPD+'" data-plugin="Dirble" data-path="Dirble"><i class="fa fa-globe"></i><h3>Dirble</h3>radio stations open directory</div>'+divClose;}}
if(chkKey(obj.Jamendo)){if(isLocalHost){content+=divOpen+'<div id="home-jamendo" class="home-block'+toggleMPD+'" data-plugin="Jamendo" data-path="Jamendo"><i class="fa fa-play-circle-o"></i><h3>Jamendo<span id="home-count-jamendo"></span></h3></div>'+divClose;}else{content+=divOpen+'<div id="home-jamendo" class="home-block'+toggleMPD+'" data-plugin="Jamendo" data-path="Jamendo"><i class="fa fa-play-circle-o"></i><h3>Jamendo<span id="home-count-jamendo"></span></h3>world\'s largest platform for free music</div>'+divClose;}}
content+='</div>';document.getElementById('home-blocks').innerHTML=content;loadingSpinner('db','hide');$('span','#db-currentpath').html('');}
function refreshState(){var state=GUI.state;if(state==='play'){$('#play').addClass('btn-primary');$('i','#play').removeClass('fa fa-pause').addClass('fa fa-play');$('#stop').removeClass('btn-primary');}else if(state==='pause'){$('#playlist-position span').html('Not playing');$('#playlist-position-ss span').html('Not playing');$('#playlist-position-sss span').html('Not playing');$('#play').addClass('btn-primary');$('i','#play').removeClass('fa fa-play').addClass('fa fa-pause');$('#stop').removeClass('btn-primary');}else if(state==='stop'){$('#play').removeClass('btn-primary');$('i','#play').removeClass('fa fa-pause').addClass('fa fa-play');$('#stop').addClass('btn-primary');if($('#section-index').length){$('#countdown-display').countdown('destroy');$('#countdown-display-ss').countdown('destroy');$('#countdown-display-sss').countdown('destroy');}
if(GUI.stream==='radio'){$('#total').html('<span>&infin;</span>');$('#total-ss').html('<span>&infin;</span>');$('#total-sss').html('<span>&infin;</span>');}else{$('#total').html('00:00');$('#total-ss').html('00:00');$('#total-sss').html('00:00');}
$('#time').val(0,false).trigger('update');$('#format-bitrate').html('&nbsp;');$('#format-bitrate-ss').html('&nbsp;');$('#format-bitrate-sss').html('&nbsp;');$('li','#playlist-entries').removeClass('active');}
if(state!=='stop'){if(GUI.stream==='radio'){$('#total').html('<span>&infin;</span>');$('#total-ss').html('<span>&infin;</span>');$('#total-sss').html('<span>&infin;</span>');}else{$('#total').html((GUI.json.time!==undefined)?timeConvert(GUI.json.time):'00:00');$('#total-ss').html((GUI.json.time!==undefined)?timeConvert(GUI.json.time):'00:00');$('#total-sss').html((GUI.json.time!==undefined)?timeConvert(GUI.json.time):'00:00');}
var fileinfo=(GUI.json.audio_channels&&GUI.json.audio_sample_depth&&GUI.json.audio_sample_rate)?(GUI.json.audio_channels+', '+GUI.json.audio_sample_depth+' bit, '+GUI.json.audio_sample_rate+' kHz, '+GUI.json.bitrate+' kbps'):'&nbsp;';$('#format-bitrate').html(fileinfo);$('#format-bitrate-ss').html(fileinfo);$('#format-bitrate-sss').html(fileinfo);$('li','#playlist-entries').removeClass('active');var current=parseInt(GUI.json.song);$('#playlist-entries').find('li').eq(current).addClass('active');}
if(GUI.json.playlistlength&&GUI.json.playlistlength!=='0'){if(GUI.json.song){$('#playlist-position span').html('Playlist position '+(parseInt(GUI.json.song)+1)+'/'+GUI.json.playlistlength);$('#playlist-position-ss span').html('Playlist position '+(parseInt(GUI.json.song)+1)+'/'+GUI.json.playlistlength);$('#playlist-position-sss span').html('Playlist position '+(parseInt(GUI.json.song)+1)+'/'+GUI.json.playlistlength);}else{$('#playlist-position span').html('Playlist position 1/'+GUI.json.playlistlength);$('#playlist-position-ss span').html('Playlist position 1/'+GUI.json.playlistlength);$('#playlist-position-sss span').html('Playlist position 1/'+GUI.json.playlistlength);}}else{$('#playlist-position span').html('Empty queue, add some music!');$('#playlist-position-ss span').html('Empty queue, add some music!');$('#playlist-position-sss span').html('Empty queue, add some music!');}
if(GUI.json.updating_db!==undefined){$('a','#open-panel-sx').html('<i class="fa fa-refresh fa-spin"></i> Updating');}else{$('a','#open-panel-sx').html('<i class="fa fa-music sx"></i> Library');}}
function updateGUI(){var volume=GUI.json.volume;var radioname=GUI.json.radioname;var currentartist=GUI.json.currentartist;var currentsong=((typeof GUI.json.currentsong=='undefined')?'':GUI.json.currentsong);var currentalbum=GUI.json.currentalbum;GUI.stream=((radioname!==null&&radioname!==undefined&&radioname!=='')?'radio':'');refreshState();if($('#section-index').length){if(GUI.currentsong!==GUI.json.currentsong){countdownRestart(0);if($('#panel-dx').hasClass('active')){var current=parseInt(GUI.json.song);customScroll('pl',current);}}
if(GUI.vol_changed_local===0){$('#volume').val((volume==='-1')?100:volume,false).trigger('update');}
if(currentartist===null||currentartist.length>55){$('#currentartist-ss')[0].style.fontSize="20px";$('#currentartist-sss')[0].style.fontSize="32px";}else if(currentartist.length>45){$('#currentartist-ss')[0].style.fontSize="22px";$('#currentartist-sss')[0].style.fontSize="34px";}else if(currentartist.length>30){$('#currentartist-ss')[0].style.fontSize="26px";$('#currentartist-sss')[0].style.fontSize="36px";}else{$('#currentartist-ss')[0].style.fontSize="30px";$('#currentartist-sss')[0].style.fontSize="38px";}
$('#currentartist').html((currentartist===null||currentartist===undefined||currentartist==='')?'<span class="notag">[no artist]</span>':currentartist);$('#currentartist-ss').html((currentartist===null||currentartist===undefined||currentartist==='')?'<span class="notag">[no artist]</span>':currentartist);$('#currentartist-sss').html((currentartist===null||currentartist===undefined||currentartist==='')?'<span class="notag">[no artist]</span>':currentartist);if(currentsong===null||currentsong.length>45){$('#currentsong-ss')[0].style.fontSize="25px";$('#currentsong-sss')[0].style.fontSize="34px";}else if(currentsong.length>35){$('#currentsong-ss')[0].style.fontSize="30px";$('#currentsong-sss')[0].style.fontSize="36px";}else if(currentsong.length>25){$('#currentsong-ss')[0].style.fontSize="35px";$('#currentsong-sss')[0].style.fontSize="38px";}else{$('#currentsong-ss')[0].style.fontSize="40px";$('#currentsong-sss')[0].style.fontSize="40px";}
$('#currentsong').html((currentsong===null||currentsong===undefined||currentsong==='')?'<span class="notag">[no title]</span>':currentsong);$('#currentsong-ss').html((currentsong===null||currentsong===undefined||currentsong==='')?'<span class="notag">[no title]</span>':currentsong);$('#currentsong-sss').html((currentsong===null||currentsong===undefined||currentsong==='')?'<span class="notag">[no title]</span>':currentsong);if(currentalbum===null||currentalbum.length>55){$('#currentalbum-ss')[0].style.fontSize="20px";$('#currentalbum-sss')[0].style.fontSize="32px";}else if(currentalbum.length>45){$('#currentalbum-ss')[0].style.fontSize="22px";$('#currentalbum-sss')[0].style.fontSize="34px";}else if(currentalbum.length>30){$('#currentalbum-ss')[0].style.fontSize="26px";$('#currentalbum-sss')[0].style.fontSize="36px";}else{$('#currentalbum-ss')[0].style.fontSize="30px";$('#currentalbum-sss')[0].style.fontSize="38px";}
$('#currentalbum').html((currentalbum===null||currentalbum===undefined||currentalbum==='')?'<span class="notag">[no album]</span>':currentalbum);$('#currentalbum-ss').html((currentalbum===null||currentalbum===undefined||currentalbum==='')?'<span class="notag">[no album]</span>':currentalbum);$('#currentalbum-sss').html((currentalbum===null||currentalbum===undefined||currentalbum==='')?'<span class="notag">[no album]</span>':currentalbum);if(GUI.json.repeat==='1'){$('#repeat').addClass('btn-primary');}else{$('#repeat').removeClass('btn-primary');}
if(GUI.json.random==='1'){$('#random').addClass('btn-primary');}else{$('#random').removeClass('btn-primary');}
if(GUI.json.consume==='1'){$('#consume').addClass('btn-primary');}else{$('#consume').removeClass('btn-primary');}
if(GUI.json.single==='1'){$('#single').addClass('btn-primary');}else{$('#single').removeClass('btn-primary');}
if(GUI.currentsong!==currentsong){$('#lyric-text-overlay').html('');if(GUI.stream!=='radio'){$.ajax({url:'/lyric/',success:function(data){$('#lyric-text-overlay').html(data);},cache:false});}}
GUI.currentsong=currentsong;var currentalbumstring=currentartist+' - '+currentalbum;if(GUI.old_state!==GUI.state||GUI.currentalbum!==currentalbumstring){GUI.old_state=GUI.state;$('#artist-bio-ss').html('');$('#artist-image-ss').css('background-image','');$('#addinfo-text-ss').html('');$('#artist-bio-overlay').html('');$('#artist-image-overlay').css('background-image','');$('#addinfo-text-overlay').html('');var covercachenum=Math.floor(Math.random()*1001);$('#cover-art').css('background-image','url("/coverart/?v='+covercachenum+'")');$('#cover-art-ss').css('background-image','url("/coverart/?v='+covercachenum+'")');$('#cover-art-sss').css('background-image','url("/coverart/?v='+covercachenum+'")');$.ajax({url:'/artist_info/',success:function(data){var info=jQuery.parseJSON(data);if(typeof info.artist.bio.content!=='undefined'&&info.artist.bio.content!==''){$('#artist-bio-ss').html(info.artist.bio.content.substring(0,550)+' ... ');$('#artist-bio-overlay').html(info.artist.bio.summary);$('#artist-bio-full-overlay').html(info.artist.bio.content);}else{$('#artist-bio-ss').html(currentartist+', sorry, no details available ');$('#artist-bio-overlay').html(currentartist+', sorry, no details available ');$('#artist-bio-full-overlay').html(currentartist+', sorry, no details available ');}
if(typeof info.artist.similar.artist[0]!=='undefined'&&info.artist.similar.artist[0].name!==''){$('#addinfo-text-ss').html('Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[0].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[1].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[2].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[3].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[4].name);$('#addinfo-text-overlay').html('Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[0].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[1].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[2].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[3].name+'<br>&nbsp;&nbsp;&nbsp;&nbsp;'+info.artist.similar.artist[4].name+'<br>&nbsp;<br>&nbsp;');}else{$('#addinfo-text-ss').html('');$('#addinfo-text-overlay').html('');}
if(typeof info.artist.image[2]["#text"]!=='undefined'&&info.artist.image[2]["#text"]!==''){$('#artist-image-ss').css('background-image','url("'+info.artist.image[2]["#text"]+'")');$('#artist-image-overlay').css('background-image','url("'+info.artist.image[2]["#text"]+'")');}else{$('#artist-image-ss').css('background-image','url("assets/img/unkown.png")');$('#artist-image-overlay').css('background-image','url("assets/img/unkown.png")');}},cache:false});}
GUI.currentalbum=currentalbumstring;}}
function getPlaylistPlain(data){var current=parseInt(GUI.json.song)+1;var state=GUI.json.state;var content='',time='',artist='',album='',title='',name='',str='',filename='',path='',id=0,songid='',bottomline='',totaltime=0,playlisttime=0,pos=0;var i,line,lines=data.split('\n'),infos=[];for(i=0;(line=lines[i]);i+=1){infos=line.split(/: (.+)?/);if('Time'===infos[0]){time=parseInt(infos[1]);}
else if('Artist'===infos[0]){artist=infos[1];}
else if('Title'===infos[0]){title=infos[1];}
else if('Name'===infos[0]){name=infos[1];}
else if('Album'===infos[0]){album=infos[1];}
else if('file'===infos[0]){str=infos[1];}
else if('Id'===infos[0]){songid=infos[1];if(title===''||album===''){path=parsePath(str);filename=str.split('/').pop();title=filename;if(artist===''){bottomline='path: '+path;}else{bottomline=artist;}}else{bottomline=artist+' - '+album;}
if(name!==''){title='<i class="fa fa-microphone"></i>'+name;bottomline='URL: '+(path==='')?str:path;totaltime='';}else{totaltime='<span>'+timeConvert2(time)+'</span>';playlisttime+=time;}
pos++;content+='<li id="pl-'+songid+'"'+(state!=='stop'&&pos===current?' class="active"':'')+'><i class="fa fa-times-circle pl-action" title="Remove song from playlist"></i><span class="sn">'+title+totaltime+'</span><span class="bl">'+bottomline+'</span></li>';time='';artist='';album='';title='';name='';}}
$('.playlist').addClass('hide');$('#playlist-entries').removeClass('hide');var pl_entries=document.getElementById('playlist-entries');if(pl_entries){pl_entries.innerHTML=content;}
$('#pl-filter-results').addClass('hide').html('');$('#pl-filter').val('');$('#pl-manage').removeClass('hide');$('#pl-count').removeClass('hide').html(pos+((pos!==1)?' entries':' entry')+' '+timeConvert3(playlisttime)+' total playtime');}
function getPlaylistCmd(){loadingSpinner('pl');$.ajax({url:'/db/?cmd=playlist',success:function(data){if(data.length>4){$('.playlist').addClass('hide');$('#playlist-entries').removeClass('hide');getPlaylistPlain(data);var current=parseInt(GUI.json.song);if($('#panel-dx').hasClass('active')&&GUI.currentsong!==GUI.json.currentsong){customScroll('pl',current,200);}}else{$('.playlist').addClass('hide');$('#playlist-warning').removeClass('hide');$('#pl-filter-results').addClass('hide').html('');$('#pl-count').removeClass('hide').html('0 entries');}
loadingSpinner('pl','hide');},cache:false});}
function getPlaylist(text){data=text[0];if(data.length>4){$('.playlist').addClass('hide');$('#playlist-entries').removeClass('hide');getPlaylistPlain(data);var current=parseInt(GUI.json.song);if($('#panel-dx').hasClass('active')&&GUI.currentsong!==GUI.json.currentsong){customScroll('pl',current,200);}}else{$('.playlist').addClass('hide');$('#playlist-warning').removeClass('hide');$('#pl-filter-results').addClass('hide').html('');$('#pl-count').removeClass('hide').html('0 entries');}
loadingSpinner('pl','hide');}
function renderUI(text){toggleLoader('close');GUI.json=text[0];GUI.state=GUI.json.state;updateGUI();if($('#section-index').length){var elapsed=(GUI.json.elapsed!==''&&GUI.json.elapsed!==undefined)?GUI.json.elapsed:0;var time=(GUI.json.time!==''&&GUI.json.time!==undefined&&GUI.json.time!==null)?GUI.json.time:0;refreshTimer(parseInt(elapsed),parseInt(time),GUI.json.state);if(GUI.stream!=='radio'){refreshKnob();}else{$('#time').val(0,false).trigger('update');}
if(GUI.json.playlist!==GUI.playlist){getPlaylistCmd();GUI.playlist=GUI.json.playlist;}}
checkPlayerState()}
function renderPlaylists(data){var content='',playlistname='';var i,line,lines=data.split('\n'),infos=[];for(i=0;(line=lines[i]);i+=1){infos=line.split(': ');if('playlist'===infos[0]){playlistname=infos[1];content+='<li class="pl-folder" data-path="'+playlistname+'"><i class="fa fa-bars pl-action" data-target="#context-menu-playlist" data-toggle="context" title="Actions"></i><span><i class="fa fa-list-ol"></i>'+playlistname+'</span></li>';playlistname='';}}
document.getElementById('playlist-entries').innerHTML='';$('.playlist').addClass('hide');$('#pl-manage').addClass('hide');$('#pl-count').addClass('hide');$('#pl-filter-results').removeClass('hide').addClass('back-to-queue').html('<i class="fa fa-arrow-left sx"></i> to queue');$('#pl-currentpath').removeClass('hide');$('#pl-editor').removeClass('hide');document.getElementById('pl-editor').innerHTML=content;loadingSpinner('pl','hide');}
function getPlaylists(){loadingSpinner('pl');$.ajax({url:'/command/?cmd=listplaylists',success:function(data){renderPlaylists(data);},cache:false});}
function updatePlaylistDropdown(data){var i,line,lines=data.split('\n'),infos=[];var options='';for(i=0;(line=lines[i]);i+=1){infos=line.split(': ');if('playlist'===infos[0]){options+='<option value="'+infos[1]+'" />';}}
document.getElementById('pl-list').innerHTML=options;loadingSpinner('pl','hide');}
function getPlaylistsDropdown(){loadingSpinner('pl');$.ajax({url:'/command/?cmd=listplaylists',success:function(data){updatePlaylistDropdown(data);},cache:false});}
function parseResponse(options){var inputArr=options.inputArr||'',respType=options.respType||'',i=options.i||0,inpath=options.inpath||'',querytype=options.querytype||'',content='';switch(respType){case'playlist':break;case'db':if(GUI.browsemode==='file'){if(inpath===''&&inputArr.file!==undefined){inpath=parsePath(inputArr.file);}
if(inputArr.file!==undefined||inpath==='Webradio'){content='<li id="db-'+(i+1)+'" data-path="';if(inputArr.Title!==undefined){content+=inputArr.file;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';content+=inputArr.Title+' <span>'+timeConvert(inputArr.Time)+'</span></span>';content+=' <span class="bl">';content+=inputArr.Artist;content+=' - ';content+=inputArr.Album;}else{if(inpath!=='Webradio'){content+=inputArr.file;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';content+=inputArr.file.replace(inpath+'/','')+' <span>'+timeConvert(inputArr.Time)+'</span></span>';content+='<span class="bl">';content+=' path: ';content+=inpath;}else{content+=inputArr.playlist;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-webradio"></i><i class="fa fa-microphone db-icon db-radio"></i>';content+='<span class="sn">'+inputArr.playlist.replace(inpath+'/','').replace('.'+inputArr.fileext,'');content+='</span><span class="bl">webradio';}}
content+='</span></li>';}else if(inputArr.playlist!==undefined){if(inputArr.fileext==='cue'){content='<li id="db-'+(i+1)+'" data-path="';content+=inputArr.playlist;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-file-text db-icon"></i><span class="sn">';content+=inputArr.playlist.replace(inpath+'/','')+' <span>[CUE file]</span></span>';content+='<span class="bl">';content+=' path: ';content+=inpath;content+='</span></li>';}}else{content='<li id="db-'+(i+1)+'" class="db-folder" data-path="';content+=inputArr.directory;if(inpath!==''){content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu"></i><span><i class="fa fa-folder-open"></i>';}else{content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-root"></i><i class="fa fa-hdd-o icon-root"></i><span>';}
content+=inputArr.directory.replace(inpath+'/','');content+='</span></li>';}}else if(GUI.browsemode==='album'||GUI.browsemode==='albumfilter'){if(inputArr.file!==undefined){content='<li id="db-'+(i+1)+'" data-path="';content+=inputArr.file;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';content+=inputArr.Title+' <span>'+timeConvert(inputArr.Time)+'</span></span>';content+=' <span class="bl">';content+=inputArr.Artist;content+=' - ';content+=inputArr.Album;content+='</span></li>';}else if(inputArr.album!==''){content='<li id="db-'+(i+1)+'" class="db-folder db-album" data-path="';content+=inputArr.album.replace(/\"/g,'&quot;');content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>';content+=inputArr.album;content+='</span></li>';}}else if(GUI.browsemode==='artist'){if(inputArr.album!==undefined){content='<li id="db-'+(i+1)+'" class="db-folder db-album" data-path="';content+=inputArr.album;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>';content+=(inputArr.album!=='')?inputArr.album:'Unknown album';content+='</span></li>';}else if(inputArr.artist!==''){content='<li id="db-'+(i+1)+'" class="db-folder db-artist" data-path="';content+=inputArr.artist;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-user"></i>';content+=inputArr.artist;content+='</span></li>';}}else if(GUI.browsemode==='composer'){if(inputArr.file!==undefined){content='<li id="db-'+(i+1)+'" data-path="';content+=inputArr.file;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';content+=inputArr.Title+' <span>'+timeConvert(inputArr.Time)+'</span></span>';content+=' <span class="bl">';content+=inputArr.Artist;content+=' - ';content+=inputArr.Album;content+='</span></li>';}else if(inputArr.composer!==''){content='<li id="db-'+(i+1)+'" class="db-folder db-composer" data-path="';content+=inputArr.composer;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-composer"></i><span><i class="fa fa-user"></i>';content+=inputArr.composer;content+='</span></li>';}}else if(GUI.browsemode==='genre'){if(inputArr.artist!==undefined){content='<li id="db-'+(i+1)+'" class="db-folder db-artist" data-path="';content+=inputArr.artist;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-dot-circle-o"></i>';content+=(inputArr.artist!=='')?inputArr.artist:'Unknown artist';content+='</span></li>';}else if(inputArr.genre!==''){content='<li id="db-'+(i+1)+'" class="db-folder db-genre" data-path="';content+=inputArr.genre;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-genre"></i><span><i class="fa fa-tags"></i>';content+=inputArr.genre;content+='</span></li>';}}
break;case'Spotify':if(querytype===''){content='<li id="db-'+(i+1)+'" class="db-spotify db-folder" data-path="';content+=inputArr.index;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify-pl"></i><span><i class="fa fa-folder-open"></i>';content+=(inputArr.name!=='')?inputArr.name:'Favorites';content+=' (';content+=inputArr.tracks;content+=')</span></li>';}else if(querytype==='tracks'){content='<li id="db-'+(i+1)+'" class="db-spotify" data-path="';content+=inputArr.index;content+='" data-plid="';content+=inpath;content+='" data-type="spotify-track"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify"></i><i class="fa fa-spotify db-icon"></i><span class="sn">';content+=inputArr.title+' <span>'+timeConvert(inputArr.duration/1000)+'</span></span>';content+=' <span class="bl">';content+=inputArr.artist;content+=' - ';content+=inputArr.album;content+='</span></li>';}
break;case'Dirble':if(querytype===''||querytype==='childs'){var childClass=(querytype==='childs')?' db-dirble-child':'';content='<li id="db-'+(i+1)+'" class="db-dirble db-folder'+childClass+'" data-path="';content+=inputArr.id;content+='"><span><i class="fa fa-folder-open"></i>';content+=inputArr.title;content+='</span></li>';}else if(querytype==='search'||querytype==='stations'||querytype==='childs-stations'){if(inputArr.streams.length===0){break;}
content='<li id="db-'+(i+1)+'" class="db-dirble db-radio" data-path="';content+=inputArr.name+' | '+inputArr.streams[0].stream;content+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-dirble"></i><i class="fa fa-microphone db-icon"></i>';content+='<span class="sn">'+inputArr.name+'<span>('+inputArr.country+')</span></span>';content+='<span class="bl">';content+=inputArr.website?inputArr.website:'-no website-';content+='</span></li>';}
break;case'Jamendo':content='<li id="db-'+(i+1)+'" class="db-jamendo db-folder" data-path="';content+=inputArr.stream;content+='"><img class="jamendo-cover" src="/tun/'+inputArr.image+'" alt=""><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i>';content+=inputArr.dispname+'</div></li>';break;}
return content;}
function populateDB(options){var data=options.data||'',path=options.path||'',uplevel=options.uplevel||0,keyword=options.keyword||'',plugin=options.plugin||'',querytype=options.querytype||'',args=options.args||'',content='',i=0,row=[];console.log(JSON.stringify(data));if(plugin!==''){if(plugin==='Spotify'){$('#database-entries').removeClass('hide');$('#db-level-up').removeClass('hide');$('#home-blocks').addClass('hide');if(path){GUI.currentpath=path;}
document.getElementById('database-entries').innerHTML='';data=(querytype==='tracks')?data.tracks:data.playlists;data.sort(function(a,b){if(path==='Spotify'&&querytype===''){nameA=a.hasOwnProperty('name')?a.name.toLowerCase():'';nameB=b.hasOwnProperty('name')?b.name.toLowerCase():'';}else if(querytype==='tracks'){nameA=a.hasOwnProperty('title')?a.title.toLowerCase():'';nameB=b.hasOwnProperty('title')?b.title.toLowerCase():'';}else{return 0;}
return nameA.localeCompare(nameB);});for(i=0;(row=data[i]);i+=1){content+=parseResponse({inputArr:row,respType:'Spotify',i:i,querytype:querytype,inpath:args});}
document.getElementById('database-entries').innerHTML=content;}
if(plugin==='Dirble'){$('#database-entries').removeClass('hide');$('#db-level-up').removeClass('hide');$('#home-blocks').addClass('hide');if(path){if(querytype==='search'){GUI.currentpath='Dirble';}else{GUI.currentpath=path;}}
if(querytype==='childs-stations'){content=document.getElementById('database-entries').innerHTML;}else{document.getElementById('database-entries').innerHTML='';}
data.sort(function(a,b){if(querytype===''||querytype==='childs'||querytype==='categories'){nameA=a.hasOwnProperty('title')?a.title.toLowerCase():'';nameB=b.hasOwnProperty('title')?b.title.toLowerCase():'';}else if(querytype==='childs-stations'||querytype==='stations'){nameA=a.hasOwnProperty('name')?a.name.toLowerCase():'';nameB=b.hasOwnProperty('name')?b.name.toLowerCase():'';}else{return 0;}
return nameA.localeCompare(nameB);});for(i=0;(row=data[i]);i+=1){content+=parseResponse({inputArr:row,respType:'Dirble',i:i,querytype:querytype});}
document.getElementById('database-entries').innerHTML=content;}
if(plugin==='Jamendo'){$('#database-entries').removeClass('hide');$('#db-level-up').removeClass('hide');$('#home-blocks').addClass('hide');if(path){GUI.currentpath=path;}
document.getElementById('database-entries').innerHTML='';data.sort(function(a,b){if(path==='Jamendo'&&querytype===''){nameA=a.hasOwnProperty('dispname')?a.dispname.toLowerCase():'';nameB=b.hasOwnProperty('dispname')?b.dispname.toLowerCase():'';}else{return 0;}
return nameA.localeCompare(nameB);});for(i=0;(row=data[i]);i+=1){content+=parseResponse({inputArr:row,respType:'Jamendo',i:i,querytype:querytype});}
document.getElementById('database-entries').innerHTML=content;}}else{if(path===''&&keyword===''){renderLibraryHome();return;}else{$('#database-entries').removeClass('hide');$('#db-level-up').removeClass('hide');$('#home-blocks').addClass('hide');if(path){GUI.currentpath=path;}
document.getElementById('database-entries').innerHTML='';if(keyword!==''){var results=(data.length)?data.length:'0';var s=(data.length===1)?'':'s';$('#db-level-up').addClass('hide');$('#db-search-results').removeClass('hide').html('<i class="fa fa-times sx"></i><span class="visible-xs-inline">back</span><span class="hidden-xs">'+results+' result'+s+' for "<span class="keyword">'+keyword+'</span>"</span>');}
data.sort(function(a,b){if(path==='Artists'||path==='AlbumArtists'||path==='Various Artists'){nameA=a.hasOwnProperty('artist')?a.artist.toLowerCase():'';nameB=b.hasOwnProperty('artist')?b.artist.toLowerCase():'';}else if(path==='Albums'){nameA=a.hasOwnProperty('album')?a.album.toLowerCase():'';nameB=b.hasOwnProperty('album')?b.album.toLowerCase():'';}else if(path==='Webradio'){nameA=a.hasOwnProperty('playlist')?a.playlist.toLowerCase():'';nameB=b.hasOwnProperty('playlist')?b.playlist.toLowerCase():'';}else if(path==='Genres'){nameA=a.hasOwnProperty('genre')?a.genre.toLowerCase():'';nameB=b.hasOwnProperty('genre')?b.genre.toLowerCase():'';}else if(path){nameA=a.hasOwnProperty('directory')?a.directory.toLowerCase():'';nameB=b.hasOwnProperty('directory')?b.directory.toLowerCase():'';}else{return 0;}
return nameA.localeCompare(nameB);});if(path==='Webradio'){content+='<li id="webradio-add" class="db-webradio-add"><i class="fa fa-plus-circle db-icon"></i><span class="sn"><em>add new</em></span><span class="bl">add a webradio to your library</span></li>';}
for(i=0;(row=data[i]);i+=1){content+=parseResponse({inputArr:row,respType:'db',i:i,inpath:path});}
document.getElementById('database-entries').innerHTML=content;}}
var breadcrumb=$('span','#db-currentpath');if(GUI.browsemode==='album'){if(path==='Albums'){breadcrumb.html(path);}else{breadcrumb.html('Albums/'+path);}}else if(GUI.browsemode==='artist'){if(path==='Artists'){breadcrumb.html(path);}else{breadcrumb.html('Artists/'+path);}}else if(GUI.browsemode==='composer'){if(path==='Composer'){breadcrumb.html(path);}else{breadcrumb.html('Composer/'+path);}}else if(GUI.browsemode==='genre'){if(path==='Genres'){breadcrumb.html(path);}else{breadcrumb.html('Genres/'+path);}}else{breadcrumb.html(path);}
$('#db-homeSetup').addClass('hide');if(uplevel){var position=GUI.currentDBpos[GUI.currentDBpos[10]];$('#db-'+position).addClass('active');customScroll('db',position,0);}else{customScroll('db',0,0);}
if(querytype!='childs'){loadingSpinner('db','hide');}}
function getDB(options){var cmd=options.cmd||'browse',path=options.path||'',browsemode=options.browsemode||'file',uplevel=options.uplevel||'',plugin=options.plugin||'',querytype=options.querytype||'',args=options.args||'';loadingSpinner('db');GUI.browsemode=browsemode;if(plugin!==''){if(plugin==='Spotify'){$.post('/db/?cmd=spotify',{'plid':args},function(data){populateDB({data:data,path:path,plugin:plugin,querytype:querytype,uplevel:uplevel,args:args});},'json');}
else if(plugin==='Dirble'){if(querytype==='childs'){$.post('/db/?cmd=dirble',{'querytype':'childs','args':args},function(data){populateDB({data:data,path:path,plugin:plugin,querytype:'childs',uplevel:uplevel});},'json');$.post('/db/?cmd=dirble',{'querytype':'childs-stations','args':args},function(data){populateDB({data:data,path:path,plugin:plugin,querytype:'childs-stations',uplevel:uplevel});},'json');}else{$.post('/db/?cmd=dirble',{'querytype':(querytype==='')?'categories':querytype,'args':args},function(data){populateDB({data:data,path:path,plugin:plugin,querytype:querytype,uplevel:uplevel});},'json');}}
else if(plugin==='Jamendo'){$.post('/db/?cmd=jamendo',{'querytype':(querytype==='')?'radio':querytype,'args':args},function(data){populateDB({data:data.results,path:path,plugin:plugin,querytype:querytype});},'json');}}else{if(cmd==='search'){var keyword=$('#db-search-keyword').val();if(path.match(/Dirble/)){$.post('/db/?cmd=dirble',{'querytype':'search','args':keyword},function(data){populateDB({data:data,path:path,plugin:'Dirble',querytype:'search',uplevel:uplevel});},'json');}else{$.post('/db/?querytype='+GUI.browsemode+'&cmd=search',{'query':keyword},function(data){populateDB({data:data,path:path,uplevel:uplevel,keyword:keyword});},'json');}}else if(cmd==='browse'){$.post('/db/?cmd=browse',{'path':path,'browsemode':GUI.browsemode},function(data){populateDB({data:data,path:path,uplevel:uplevel});},'json');}else{loadingSpinner('db','hide');$.post('/db/?cmd='+cmd,{'path':path,'querytype':querytype},function(path){},'json');}}}
function onreleaseKnob(value){if(GUI.state!=='stop'&&GUI.state!==''){if(GUI.stream!=='radio'){window.clearInterval(GUI.currentKnob);var seekto=Math.floor((value*parseInt(GUI.json.time))/1000);sendCmd('seek '+GUI.json.song+' '+seekto);$('#time').val(value);$('#countdown-display').countdown('destroy');$('#countdown-display-ss').countdown('destroy');$('#countdown-display-sss').countdown('destroy');$('#countdown-display').countdown({since:-seekto,compact:true,format:'MS'});$('#countdown-display-ss').countdown({since:-seekto,compact:true,format:'MS'});$('#countdown-display-sss').countdown({since:-seekto,compact:true,format:'MS'});}else{$('#time').val(0).trigger('change');}}}
function commandButton(el){var dataCmd=el.data('cmd');var cmd;if(dataCmd==='stop'){el.addClass('btn-primary');$('#play').removeClass('btn-primary');if($('#section-index').length){refreshTimer(0,0,'stop');window.clearInterval(GUI.currentKnob);$('.playlist').find('li').removeClass('active');$('#total').html('00:00');$('#total-ss').html('00:00');$('#total-sss').html('00:00');}}
else if(dataCmd==='play'){var state=GUI.state;if(state==='play'){cmd='pause';if($('#section-index').length){$('#countdown-display').countdown('pause');$('#countdown-display-ss').countdown('pause');$('#countdown-display-sss').countdown('pause');}}else if(state==='pause'){cmd='play';if($('#section-index').length){$('#countdown-display').countdown('resume');$('#countdown-display-ss').countdown('resume');$('#countdown-display-sss').countdown('resume');}}else if(state==='stop'){cmd='play';if($('#section-index').length){$('#countdown-display').countdown({since:0,compact:true,format:'MS'});$('#countdown-display-ss').countdown({since:0,compact:true,format:'MS'});$('#countdown-display-sss').countdown({since:0,compact:true,format:'MS'});}}
window.clearInterval(GUI.currentKnob);sendCmd(cmd);return;}
else if(dataCmd==='previous'||dataCmd==='next'){if($('#section-index').length){$('#countdown-display').countdown('pause');$('#countdown-display-ss').countdown('pause');$('#countdown-display-sss').countdown('pause');window.clearInterval(GUI.currentKnob);}}
else if(el.hasClass('btn-volume')){var vol;var knobvol=parseInt($('#volume').val());if(dataCmd==='volumedn'&&parseInt(GUI.volume)>0){vol=parseInt(GUI.volume)-1;GUI.volume=vol;$('#volumemute').removeClass('btn-primary');}else if(dataCmd==='volumeup'&&parseInt(GUI.volume)<100){vol=parseInt(GUI.volume)+1;GUI.volume=vol;$('#volumemute').removeClass('btn-primary');}else if(dataCmd==='volumemute'){if(knobvol!==0){GUI.volume=knobvol;el.addClass('btn-primary');vol=0;}else{el.removeClass('btn-primary');vol=GUI.volume;}}
if((vol>=0)&&(vol<=100)){sendCmd('setvol '+vol);$('#volume').val(vol,false).trigger('update');}
return;}
if(el.hasClass('btn-toggle')){cmd=dataCmd+(el.hasClass('btn-primary')?' 0':' 1');el.toggleClass('btn-primary');}else{cmd=dataCmd;}
sendCmd(cmd);}
function libraryHome(text){GUI.libraryhome=text[0];if(GUI.libraryhome.clientUUID===GUI.clientUUID&&GUI.plugin!=='Dirble'&&GUI.currentpath!=='Webradio'){renderLibraryHome();}
if(GUI.currentpath==='Webradio'){getDB({path:'Webradio',uplevel:0});}
if(GUI.forceGUIupdate===true){GUI.forceGUIupdate=false;renderLibraryHome();}}
function listWLANs(text){var i=0,content='',inrange='',stored='',wlans=text[0];$.each(wlans,function(i){content+='<p><a href="/network/wlan/'+wlans[i].nic+'/'+wlans[i].ESSID+'" class="btn btn-lg btn-default btn-block" title="See network properties">';if(wlans[i].connected!==0){content+='<i class="fa fa-check green sx"></i>';}
if(wlans[i].storedprofile===1&&wlans[i].encryption==='on'){content+='<i class="fa fa-lock sx"></i>';}else{if(wlans[i].encryption==='on'){content+='<i class="fa fa-rss fa-wifi"></i><i class="fa fa-lock sx"></i>';}else{if(wlans[i].storedprofile!==1){content+='<i class="fa fa-rss fa-wifi sx"></i>';}}}
content+='<strong>'+wlans[i].ESSID+'</strong></a></p>';if(wlans[i].origin==='scan'){inrange+=content;}
if(wlans[i].storedprofile===1){stored+=content;}
content='';});if(inrange===''){inrange='<p><a class="btn btn-lg btn-default btn-block" href="#"><i class="fa fa-cog fa-spin sx"></i>scanning for networks...</a></p>';}
document.getElementById('wifiNetworks').innerHTML=inrange;document.getElementById('wifiStored').innerHTML=stored;$.ajax({url:'/command/?cmd=wifiscan',cache:false});}
function nicsDetails(text){var i=0,content='',nics=text[0];$.each(nics,function(i){if(i===$('#nic-details').data('name')){content+='<tr><th>Name:</th><td><strong>'+i+'<strong></td></tr>';content+='<tr><th>Type:</th><td>wireless</td></tr>';if(nics[i].currentssid===null){content+='<tr><th>Status:</th><td><i class="fa fa-times red sx"></i>no network connected</td></tr>';}else{content+='<tr><th>Status:</th><td><i class="fa fa-check green sx"></i>connected</td></tr>';content+='<tr><th>Associated SSID:</th><td><strong>'+nics[i].currentssid+'</strong></td></tr>';}
content+='<tr><th>Assigned IP:</th><td>'+((nics[i].ip!==null)?('<strong>'+nics[i].ip+'</strong>'):'none')+'</td></tr>';content+='<tr><th>Speed:</th><td>'+((nics[i].speed!==null)?nics[i].speed:'unknown')+'</td></tr>';if(nics[i].currentssid!==null){content+='<tr><th>Netmask:</th><td>'+nics[i].netmask+'</td></tr>';content+='<tr><th>Gateway:</th><td>'+nics[i].gw+'</td></tr>';content+='<tr><th>DNS1:</th><td>'+nics[i].dns1+'</td></tr>';content+='<tr><th>DNS2:</th><td>'+nics[i].dns2+'</td></tr>';}}});$('#nic-details tbody').html(content);}
function playbackChannel(){var pushstream=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode,reconnectOnChannelUnavailableInterval:5000});pushstream.onmessage=renderUI;pushstream.onstatuschange=function(status){if(status===2){$('#loader').addClass('hide');sendCmd('renderui');}else{if(status===0){toggleLoader();}}};pushstream.addChannel('playback');pushstream.connect();}
function queueChannel(){var pushstream=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});pushstream.onmessage=getPlaylist;pushstream.addChannel('queue');pushstream.connect();}
function libraryChannel(){var pushstream=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});pushstream.onmessage=libraryHome;pushstream.addChannel('library');pushstream.connect();}
function notifyChannel(){var pushstream=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});pushstream.onmessage=renderMSG;pushstream.addChannel('notify');pushstream.connect();}
function wlansChannel(){var pushstream=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});pushstream.onmessage=listWLANs;pushstream.addChannel('wlans');pushstream.connect();$.ajax({url:'/command/?cmd=wifiscan',cache:false});}
function nicsChannel(){var pushstream=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});pushstream.onmessage=nicsDetails;pushstream.addChannel('nics');pushstream.connect();}
function overlayTrigger(overlayID){var overlay=$(overlayID),triggerBttn=$(overlayID+'-open'),closeBttn=$(overlayID+'-close');transEndEventNames={'WebkitTransition':'webkitTransitionEnd','MozTransition':'transitionend','OTransition':'oTransitionEnd','msTransition':'MSTransitionEnd','transition':'transitionend'};function toggleOverlay(){if(overlay.hasClass('open')){overlay.removeClass('open');overlay.addClass('closed');var onEndTransitionFn=function(ev){if(support.transitions){if(ev.propertyName!=='visibility'){return;}
this.removeEventListener(transEndEventName,onEndTransitionFn);}
overlay.removeClass('closed');};}
else if(overlay.hasClass('closed')){overlay.addClass('open');if(overlayID==='#overlay-social'){var urlTwitter='https://twitter.com/home?status=Listening+to+'+GUI.json.currentsong.replace(/\s+/g,'+')+'+by+'+GUI.json.currentartist.replace(/\s+/g,'+')+'+on+%40RuneAudio+http%3A%2F%2Fwww.runeaudio.com%2F+%23nowplaying';var urlFacebook='https://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.runeaudio.com%2F&display=popup';var urlGooglePlus='https://plus.google.com/share?url=http%3A%2F%2Fwww.runeaudio.com%2F';$('#urlTwitter').attr('href',urlTwitter);$('#urlFacebook').attr('href',urlFacebook);$('#urlGooglePlus').attr('href',urlGooglePlus);}}}
triggerBttn.click(function(){toggleOverlay();});closeBttn.click(function(){toggleOverlay();});}
function getHiddenProp(){var prefixes=['webkit','moz','ms','o'];if('hidden'in document){return'hidden';}
for(var i=0;i<prefixes.length;i++){if((prefixes[i]+'Hidden')in document){return prefixes[i]+'Hidden';}}
return null;}
function isHidden(){var prop=getHiddenProp();if(!prop){return false;}
return document[prop];}
function visChange(){if(isHidden()){GUI.visibility='hidden';}else{GUI.visibility='visible';}}
if($('#section-index').length){jQuery(document).ready(function($){'use strict';GUI.mode=checkWebSocket();playbackChannel();libraryChannel();PNotify.prototype.options.styling='fontawesome';PNotify.prototype.options.stack.dir1='up';PNotify.prototype.options.stack.dir2='left';PNotify.prototype.options.stack.firstpos1=90;PNotify.prototype.options.stack.firstpos2=50;PNotify.prototype.options.stack.spacing1=10;PNotify.prototype.options.stack.spacing2=10;notifyChannel();var visProp=getHiddenProp();if(visProp){var evtname=visProp.replace(/[H|h]idden/,'')+'visibilitychange';document.addEventListener(evtname,visChange);}
$('.btn-cmd').click(function(){var el=$(this);commandButton(el);});var intervalId;var interval;$("#volumedn").on('mouseleave mouseout mouseup',function(){clearInterval(intervalId);return false;});$('#volumedn').mousedown(function(){interval=300;intervalId=setInterval(vol_down_interval,interval+200);return false;});function vol_down_interval(){clearInterval(intervalId);interval=interval-10;if(interval<50){interval=50;}
intervalId=setInterval(vol_down_interval,interval);var vol;var knobvol=parseInt($('#volume').val());if(parseInt(GUI.volume)>0){vol=parseInt(GUI.volume)-1;GUI.volume=vol;$('#volumemute').removeClass('btn-primary');}
if((vol>=0)&&(vol<=100)){setvol(vol);$('#volume').val(vol,false).trigger('update');}}
$("#volumeup").on('mouseleave mouseout mouseup',function(){clearInterval(intervalId);return false;});$('#volumeup').mousedown(function(){interval=300;intervalId=setInterval(vol_up_interval,interval+200);return false;});function vol_up_interval(){clearInterval(intervalId);interval=interval-10;if(interval<50){interval=50;}
intervalId=setInterval(vol_up_interval,interval);var vol;var knobvol=parseInt($('#volume').val());if(parseInt(GUI.volume)<100){vol=parseInt(GUI.volume)+1;GUI.volume=vol;$('#volumemute').removeClass('btn-primary');}
if((vol>=0)&&(vol<=100)){setvol(vol);$('#volume').val(vol,false).trigger('update');}}
$('#countdown-display').click(function(){sendCmd('pause');});$('#total').click(function(){sendCmd('pause');});$('#random').click(function(){if($('#random').attr('data-cmd')==='pl-ashuffle-stop'){$.post('/db/?cmd=pl-ashuffle-stop','');$('#random').attr('data-cmd','random');$('#random').attr('title','Random');$('#random').removeClass('btn-primary');}});$('#panel-sx').click(function(){addPlayerScrollbars();});$('#panel-dx').click(function(){addPlayerScrollbars();});$('button#songinfo-open').click(function(){addPlayerScrollbars();});$('#playback').click(function(){removePlayerScrollbars();});$('button#songinfo-close-x').click(function(){removePlayerScrollbars();});$('button#songinfo-close-cancel').click(function(){removePlayerScrollbars();});$('#time').knob({inline:false,change:function(value){if(GUI.state!=='stop'){window.clearInterval(GUI.currentKnob);}else{$('#time').val(0).trigger('change');}},release:function(value){onreleaseKnob(value);}});var dynVolumeKnob=$('#volume').data('dynamic');$('#volume').knob({inline:false,change:function(value){var vol=parseInt(value);if(vol>GUI.maxvol-4&&GUI.checkvol<GUI.minvol+5){$('#volume').val(0);if(dynVolumeKnob){$(document).mouseup();}
return false;}else if(vol<GUI.minvol+4&&GUI.checkvol>GUI.maxvol-5){$('#volume').val(100);if(dynVolumeKnob){$(document).mouseup();}
return false;}
if(dynVolumeKnob&&vol!==GUI.volume){setvol(vol);}
GUI.checkvol=vol;},release:function(value){var vol=parseInt(value);if(!dynVolumeKnob&&vol!==GUI.volume){setvol(vol);}},draw:function(){if(this.$.data('skin')==='tron'){this.cursorExt=0.05;var a=this.arc(this.cv),pa,r=1;this.g.lineWidth=this.lineWidth;if(this.o.displayPrevious){pa=this.arc(this.v);this.g.beginPath();this.g.strokeStyle=this.pColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,pa.s,pa.e,pa.d);this.g.stroke();}
this.g.beginPath();this.g.strokeStyle=r?this.o.fgColor:this.fgColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,a.s,a.e,a.d);this.g.stroke();this.g.lineWidth=2;this.g.beginPath();this.g.strokeStyle=this.o.fgColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+13+this.lineWidth,0,2*Math.PI,false);this.g.stroke();return false;}}});var playlist=$('#playlist-entries');playlist.on('click','li',function(e){var cmd='';if($(e.target).hasClass('pl-action')){e.preventDefault();var id=$(this).attr('id');id=parseInt(id.replace('pl-',''));cmd='deleteid '+id;sendCmd(cmd);}else{var pos=$('li','#playlist-entries').index(this);cmd='play '+pos;sendCmd(cmd);$('li.active','#playlist-entries').removeClass('active');$(this).addClass('active');}});$('a','#open-panel-dx').click(function(){if($('#open-panel-dx').hasClass('active')){var current=parseInt(GUI.json.song);customScroll('pl',current,500);if(!$('#pl-filter-results').hasClass('hide'))
$('#pl-filter-results').click();}}).on('shown.bs.tab',function(e){var current=parseInt(GUI.json.song);customScroll('pl',current,0);});$('#open-library').click(function(){$('#open-panel-dx').removeClass('active');$('#open-panel-sx').addClass('active');});$('#pl-filter').keyup(function(){$.scrollTo(0,500);var filter=$(this).val(),count=0;$('li','#playlist-entries').each(function(){var el=$(this);if(el.text().search(new RegExp(filter,'i'))<0){el.hide();}else{el.show();count++;}});var numberItems=count;var s=(count===1)?'':'s';if(filter!==''){$('#pl-count').addClass('hide');$('#pl-filter-results').removeClass('hide').html('<i class="fa fa-times sx"></i><span class="visible-xs-inline">back</span><span class="hidden-xs">'+(+count)+' result'+s+' for "<span class="keyword">'+filter+'</span>"</span>');}else{$('#pl-count').removeClass('hide');$('#pl-filter-results').addClass('hide').html('');}});$('#pl-filter-results').click(function(){$(this).addClass('hide');$('#pl-count').removeClass('hide');if($(this).hasClass('back-to-queue')){$('.playlist').addClass('hide');getPlaylistCmd();$('#pl-currentpath').addClass('hide');$('#pl-manage').removeClass('hide');}else{$('li','#playlist-entries').each(function(){var el=$(this);el.show();});$('#pl-currentpath').removeClass('hide');$('#pl-filter').val('');}
customScroll('pl',parseInt(GUI.json.song),500);});$('#pl-manage-list').click(function(){getPlaylists();});$('#modal-pl-save-btn').click(function(){var playlistname=$('#pl-save-name').val();sendCmd('save "'+playlistname+'"');});$('#pl-editor').on('click','.pl-action',function(e){e.preventDefault();var path=$(this).parent().attr('data-path');GUI.DBentry[0]=path;});$('#pl-rename-button').click(function(){var oldname=$('#pl-rename-oldname').text();var newname=$('#pl-rename-name').val();sendCmd('rename "'+oldname+'" "'+newname+'"');getPlaylists();});$('#pl-manage-save').click(function(){getPlaylistsDropdown();});var sortlist=document.getElementById('playlist-entries');new Sortable(sortlist,{ghostClass:'sortable-ghost',onUpdate:function(evt){sortOrder(evt.item.getAttribute('id'));}});$('a','#open-panel-sx').click(function(){if($('#open-panel-sx').hasClass('active')){customScroll('pl',parseInt(GUI.json.song),500);}}).on('shown.bs.tab',function(e){customScroll('db',GUI.currentDBpos[GUI.currentDBpos[10]],0);});$('#home-blocks').on('click','.home-block',function(e){if(!$(this).hasClass('inactive')){if($(this).is('#home-spotify-switch')){$('#overlay-playsource-open').trigger('click');}else if($(e.target).is('span.block-remove')){var bookmarkID=$(this).attr('id');bookmarkID=bookmarkID.replace('home-bookmark-','');var bookmarkName=$(this).find('h3').text();$.post('/db/?cmd=bookmark',{'id':bookmarkID,'name':bookmarkName});}else{++GUI.currentDBpos[10];getDB({browsemode:$(this).data('browsemode'),path:$(this).data('path'),uplevel:0,plugin:$(this).data('plugin')});}}else{$('#overlay-playsource-open').trigger('click');}});$('#db-homeSetup').click(function(){var editbtn=$(this);if(editbtn.hasClass('btn-primary')){editbtn.removeClass('btn-primary').addClass('btn-default');$('.home-block-remove').remove();}else{editbtn.removeClass('btn-default').addClass('btn-primary');$('.home-block.home-bookmark').append('<div class="home-block-remove" title="Remove this bookmark"><span class="block-remove">&times;</span></div>');}});var db=$('#database-entries');db.on('click','li',function(e){var path='',browsemode='';var el=$(this);if($(e.target).hasClass('db-action')){e.preventDefault();if(el.data('type')==='spotify-track'){path=el.data('plid')+'-'+el.data('path');}else{path=el.data('path');}
GUI.DBentry[0]=path;}else{$('li.active','#database-entries').removeClass('active');el.addClass('active');if(el.hasClass('db-folder')){path=el.data('path');if(el.hasClass('db-album')){if(path!==''){getDB({path:path,uplevel:0,browsemode:'album'});}else{path=GUI.currentDBpath[GUI.currentDBpos[10]-1];getDB({path:path,uplevel:0,browsemode:'albumfilter'});}}else if(el.hasClass('db-artist')){getDB({path:path,uplevel:0,browsemode:'artist'});}else if(el.hasClass('db-composer')){getDB({path:path,uplevel:0,browsemode:'composer'});}else if(el.hasClass('db-genre')){getDB({path:path,uplevel:0,browsemode:'genre'});}else if(el.hasClass('db-spotify')){path=GUI.currentpath+'/'+el.find('span').text();getDB({path:path,plugin:'Spotify',args:el.data('path').toString(),querytype:'tracks'});GUI.plugin='Spotify';}else if(el.hasClass('db-dirble')){path=GUI.currentpath+'/'+el.find('span').text();var querytype=(el.hasClass('db-dirble-child'))?'stations':'childs';getDB({path:path,plugin:'Dirble',querytype:querytype,args:el.data('path')});GUI.plugin='Dirble';}else if(el.hasClass('db-jamendo')){}else{browsemode=el.data('browsemode');getDB({path:path,uplevel:0,browsemode:browsemode});}
var entryID=el.attr('id');entryID=entryID.replace('db-','');GUI.currentDBpos[GUI.currentDBpos[10]]=entryID;GUI.currentDBpath[GUI.currentDBpos[10]]=path;++GUI.currentDBpos[10];}else if(el.hasClass('db-webradio-add')){$('#modal-webradio-add').modal();}}});db.on('dblclick','li',function(e){var el=$(this);if(!$(e.target).hasClass('db-action')){$('li.active','#database-entries').removeClass('active');el.addClass('active');var path=el.data('path');if(el.hasClass('db-spotify')){path=el.attr('data-plid')+'-'+el.attr('data-path');getDB({cmd:'spaddplay',path:path,querytype:'spotify-track'});}else{path=(el.hasClass('db-dirble'))?path.split(' | ')[1]:path;getDB({cmd:'addplay',path:path});}}});$('#db-level-up').click(function(){--GUI.currentDBpos[10];var path=GUI.currentpath;if(GUI.currentDBpos[10]===0){path='';}else{if(GUI.browsemode==='file'){var cutpos=path.lastIndexOf('/');path=(cutpos!==-1)?path.slice(0,cutpos):'';}else{if(GUI.browsemode==='album'){path=GUI.currentDBpath[GUI.currentDBpos[10]-1];if(path===''){path='Albums';}else{GUI.browsemode='artist';}}else if(GUI.browsemode==='artist'){path=GUI.currentDBpath[GUI.currentDBpos[10]-1];if(path===''){path='Artists';}else{GUI.browsemode='genre';}}else if(GUI.browsemode==='composer'){path=GUI.currentDBpath[GUI.currentDBpos[10]-1];if(path===''){path='Composer';}else{GUI.browsemode='artist';}}else if(GUI.browsemode==='genre'){path='Genres';}else if(GUI.browsemode==='albumfilter'){GUI.browsemode='artist';path=GUI.currentDBpath[GUI.currentDBpos[10]-1];}}}
getDB({browsemode:GUI.browsemode,path:path,plugin:GUI.plugin,uplevel:1});GUI.plugin='';});$('#db-search-results').click(function(){$(this).addClass('hide');$('#db-level-up').removeClass('hide');getDB({path:GUI.currentpath});});$('a','.context-menu').click(function(){var dataCmd=$(this).data('cmd');var dataType=$(this).data('type');var path=GUI.DBentry[0];GUI.DBentry[0]='';switch(dataCmd){case'pl-add':sendCmd('load "'+path+'"');break;case'pl-replace':sendCmd('clear');sendCmd('load "'+path+'"');break;case'pl-addreplaceplay':sendCmd('clear');sendCmd('load "'+path+'"');sendCmd('play');break;case'pl-rename':$('#modal-pl-rename').modal();$('#pl-rename-oldname').text(path);break;case'pl-rm':$.ajax({url:'/command/?cmd=rm%20%22'+path+'%22',success:function(data){getPlaylists(data);},cache:false});break;case'pl-ashuffle':$.post('/db/?cmd=pl-ashuffle',{'playlist':path});$('#random').attr('data-cmd','pl-ashuffle-stop');$('#random').attr('title','Stop randomly adding songs');$('#random').addClass('btn-primary');break;case'wradd':path=path.split(' | ')[1];getDB({cmd:'add',path:path});break;case'wraddplay':path=path.split(' | ')[1];getDB({cmd:'addplay',path:path});break;case'wraddreplaceplay':path=path.split(' | ')[1];getDB({cmd:'addreplaceplay',path:path});break;case'wredit':$('#modal-webradio-edit').modal();$.post('/db/?cmd=readradio',{filename:path},function(data){var name=$('#webradio-edit-name');name.val(data.name);name.data('file-name',data.name);$('#webradio-edit-url').val(data.url);},'json');break;case'wrdelete':$('#modal-webradio-delete').modal();$('#webradio-delete-name').text(path.replace('Webradio/',''));break;case'wrsave':var parameters=path.split(' | ');$.post('/db/?cmd=addradio',{'radio[label]':parameters[0],'radio[url]':parameters[1]});break;default:getDB({cmd:dataCmd,path:path,browsemode:GUI.browsemode,querytype:dataType});break;}});$('#webradio-add-button').click(function(){var radioname=$('#webradio-add-name').val();var radiourl=$('#webradio-add-url').val();if(radioname===''||radiourl===''){renderMSG([{'title':'Missing fields','text':'Please fill both fields to continue','icon':'fa fa-warning'}]);}else{$.post('/db/?cmd=addradio',{'radio[label]':radioname,'radio[url]':radiourl},function(data){},'json');$('#modal-webradio-add').modal('hide');$('#webradio-add-name').val('');$('#webradio-add-url').val('');}});$('#webradio-edit-button').click(function(){var name=$('#webradio-edit-name');$.post('/db/?cmd=editradio',{'radio[newlabel]':name.val(),'radio[label]':name.data('file-name'),'radio[url]':$('#webradio-edit-url').val()},function(data){},'json');});$('#webradio-delete-button').click(function(){var radioname=$('#webradio-delete-name').text();$.post('/db/?cmd=deleteradio',{'radio[label]':radioname},function(data){},'json');});$('#db-firstPage').click(function(){$.scrollTo(0,500);});$('#db-prevPage').click(function(){var scrolloffset='-='+$(window).height()+'px';$.scrollTo(scrolloffset,500);});$('#db-nextPage').click(function(){var scrolloffset='+='+$(window).height()+'px';$.scrollTo(scrolloffset,500);});$('#db-lastPage').click(function(){$.scrollTo('100%',500);});$('#pl-firstPage').click(function(){$.scrollTo(0,500);});$('#pl-prevPage').click(function(){var scrollTop=$(window).scrollTop();var scrolloffset=scrollTop-$(window).height();$.scrollTo(scrolloffset,500);});$('#pl-nextPage').click(function(){var scrollTop=$(window).scrollTop();var scrolloffset=scrollTop+$(window).height();$.scrollTo(scrolloffset,500);});$('#pl-lastPage').click(function(){$.scrollTo('100%',500);});var url=document.location.toString();if(url.match('#')){$('#menu-bottom a[href="/#'+url.split('#')[1]+'"]').tab('show');}
$('#menu-bottom a').on('shown',function(e){if(history.pushState){history.pushState(null,null,e.target.hash);}else{window.location.hash=e.target.hash;}}).on('click',function(){if($('#overlay-social').hasClass('open')){$('.overlay-close').trigger('click');}});if($('.ttip').length){$('.ttip').tooltip();}
FastClick.attach(document.body);$('#syscmd-poweroff').click(function(){$.post('/settings/',{'syscmd':'poweroff'});toggleLoader();});$('#syscmd-reboot').click(function(){$.post('/settings/',{'syscmd':'reboot'});toggleLoader();});$('#syscmd-display_off').click(function(){$.post('/settings/',{'syscmd':'display_off'});});overlayTrigger('#overlay-social');overlayTrigger('#overlay-playsource');$('#playsource-mpd').click(function(){if($(this).hasClass('inactive')){GUI.forceGUIupdate=true;$.ajax({url:'/command/?switchplayer=MPD',cache:false});$('#overlay-playsource-close').trigger('click');}});$('#playsource-spotify').click(function(){if($(this).hasClass('inactive')){if(GUI.libraryhome.Spotify==='1'){GUI.forceGUIupdate=true;$.ajax({url:'/command/?switchplayer=Spotify',cache:false});$('#overlay-playsource-close').trigger('click');}else{new PNotify({title:'Spotify not enabled',text:'Enable and configure it under the Settings screen',icon:'fa fa-exclamation-circle'});}}});if(document.location.hostname=="localhost")
$('.osk-trigger').onScreenKeyboard({'draggable':true});});}else{jQuery(document).ready(function($){'use strict';GUI.mode=checkWebSocket();playbackChannel();PNotify.prototype.options.styling='fontawesome';PNotify.prototype.options.stack.dir1='up';PNotify.prototype.options.stack.dir2='left';PNotify.prototype.options.stack.firstpos1=90;PNotify.prototype.options.stack.firstpos2=50;PNotify.prototype.options.stack.spacing1=10;PNotify.prototype.options.stack.spacing2=10;notifyChannel();$('.btn-cmd').click(function(){var el=$(this);commandButton(el);});$('#syscmd-poweroff').click(function(){$.post('/settings/',{'syscmd':'poweroff'});toggleLoader();});$('#syscmd-reboot').click(function(){$.post('/settings/',{'syscmd':'reboot'});toggleLoader();});$('#syscmd-display_off').click(function(){$.post('/settings/',{'syscmd':'display_off'});});$('.selectpicker').selectpicker();if($('#section-sources').length){if($('#mount-type').val()==='nfs'){$('#mount-cifs').addClass('disabled').children('.disabler').removeClass('hide');}
$('#mount-type').change(function(){if($(this).val()==='cifs'||$(this).val()==='osx'){$('#mount-cifs').removeClass('disabled').children('.disabler').addClass('hide');}
else{$('#mount-cifs').addClass('disabled').children('.disabler').removeClass('hide');}});$('#nas-guest').change(function(){if($(this).prop('checked')){$('#mount-auth').addClass('disabled').children('.disabler').removeClass('hide');}else{$('#mount-auth').removeClass('disabled').children('.disabler').addClass('hide');}});$('#nas-advanced').change(function(){if($(this).prop('checked')){$('#mount-advanced-config').removeClass('hide');}else{$('#mount-advanced-config').addClass('hide');}});$('#show-mount-advanced-config').click(function(e){e.preventDefault();if($(this).hasClass('active')){$('#mount-advanced-config').toggleClass('hide');$(this).removeClass('active');$(this).find('i').removeClass('fa fa-minus-circle').addClass('fa fa-plus-circle');$(this).find('span').html('show advanced options');}else{$('#mount-advanced-config').toggleClass('hide');$(this).addClass('active');$(this).find('i').removeClass('fa fa-plus-circle').addClass('fa fa-minus-circle');$(this).find('span').html('hide advanced options');}});$('#usb-mount-list a').click(function(){var mountName=$(this).data('mount');$('#usb-umount-name').html(mountName);$('#usb-umount').val(mountName);});}
if($('#section-settings').length){$('#airplay').change(function(){if($(this).prop('checked')){$('#airplayName').removeClass('hide');$('#airplayBox').addClass('boxed-group');}else{$('#airplayName').addClass('hide');$('#airplayBox').removeClass('boxed-group');}});$('#scrobbling-lastfm').change(function(){if($(this).prop('checked')){$('#lastfmAuth').removeClass('hide');$('#lastfmBox').addClass('boxed-group');}else{$('#lastfmAuth').addClass('hide');$('#lastfmBox').removeClass('boxed-group');}});$('#proxy').change(function(){if($(this).prop('checked')){$('#proxyAuth').removeClass('hide');$('#proxyBox').addClass('boxed-group');}else{$('#proxyAuth').addClass('hide');$('#proxyBox').removeClass('boxed-group');}});$('#dlna').change(function(){if($(this).prop('checked')){$('#dlnaName').removeClass('hide');$('#dlnaBox').addClass('boxed-group');}else{$('#dlnaName').addClass('hide');$('#dlnaBox').removeClass('boxed-group');}});$('#local_browser').change(function(){if($(this).prop('checked')){$('#local_browserName').removeClass('hide');$('#local_browserBox').addClass('boxed-group');}else{$('#local_browserName').addClass('hide');$('#local_browserBox').removeClass('boxed-group');}});$('#dlnaTidal').change(function(){if($(this).prop('checked')){$('#dlnaTidalName').removeClass('hide');$('#dlnaTidalBox').addClass('boxed-group');}else{$('#dlnaTidalName').addClass('hide');$('#dlnaTidalBox').removeClass('boxed-group');}});$('#dlnaGoogle').change(function(){if($(this).prop('checked')){$('#dlnaGoogleName').removeClass('hide');$('#dlnaGoogleBox').addClass('boxed-group');}else{$('#dlnaGoogleName').addClass('hide');$('#dlnaGoogleBox').removeClass('boxed-group');}});$('#dlnaQobuz').change(function(){if($(this).prop('checked')){$('#dlnaQobuzName').removeClass('hide');$('#dlnaQobuzBox').addClass('boxed-group');}else{$('#dlnaQobuzName').addClass('hide');$('#dlnaQobuzBox').removeClass('boxed-group');}});$('#spotify').change(function(){if($(this).prop('checked')){$('#spotifyAuth').removeClass('hide');$('#spotifyBox').addClass('boxed-group');}else{$('#spotifyAuth').addClass('hide');$('#spotifyBox').removeClass('boxed-group');}});$('#spotifyconnect').change(function(){if($(this).prop('checked')){$('#spotifyconnectAuth').removeClass('hide');$('#spotifyconnectBox').addClass('boxed-group');}else{$('#spotifyconnectAuth').addClass('hide');$('#spotifyconnectBox').removeClass('boxed-group');}});$('#samba').change(function(){if($(this).prop('checked')){$('#sambaAuth').removeClass('hide');$('#sambaBox').addClass('boxed-group');}else{$('#sambaAuth').addClass('hide');$('#sambaBox').removeClass('boxed-group');}});$('#bluetooth').change(function(){if($(this).prop('checked')){$('#bluetoothAuth').removeClass('hide');$('#bluetoothBox').addClass('boxed-group');}else{$('#bluetoothAuth').addClass('hide');$('#bluetoothBox').removeClass('boxed-group');}});$('.btn-file :file').on('fileselect',function(event,numFiles,label){var input=$(this).parents('.input-group').find(':text');if(input.length){input.val(label);}else{if(label){console.log('Selected file: ',label);if(label.indexOf('backup_')>-1&&label.indexOf('.tar.gz')>-1){$('#backup-file').html(' <i class="fa fa-check dx green"></i> '+label+'');$('#btn-backup-upload').prop('disabled',false);}else{$('#backup-file').html(' <i class="fa fa-times dx red"></i> not a valid backup file');$('#btn-backup-upload').prop('disabled',true);}}}});}
if($('#section-network').length){var netManualConf=$('#network-manual-config');if($('#dhcp').val()==='0'){netManualConf.removeClass('hide');}
$('#dhcp').change(function(){if($(this).val()==='0'){netManualConf.removeClass('hide');}
else{netManualConf.addClass('hide');}});var WiFiKey=$('#wifi-security-key');if($('#wifi-security').val()!=='open'){WiFiKey.removeClass('hide');}
$('#wifi-security').change(function(){if($(this).val()!=='open'){WiFiKey.removeClass('hide');}
else{WiFiKey.addClass('hide');}});if($('#wifiNetworks').length){wlansChannel();nicsChannel();}
$('#wifiProfiles').change(function(){if($(this).prop('checked')){$('#wifiProfilesBox').addClass('hide');}else{$('#wifiProfilesBox').removeClass('hide');}});}
if($('#section-accesspoint').length){$('#accesspoint').change(function(){if($(this).prop('checked')){$('#accesspointSettings').removeClass('hide');$('#accesspointBox').addClass('boxed-group');}else{$('#accesspointSettings').addClass('hide');$('#accesspointBox').removeClass('boxed-group');}});$('#ip-address').change(function(){var parts=$('#ip-address').val().split('.');parts[3]++;$('#dhcp-range').val(parts.join('.')+','+parts[0]+'.'+parts[1]+'.'+parts[2]+'.254,24h');parts[3]=255;$('#broadcast').val(parts.join('.'));$('#dhcp-option-dns').val($('#ip-address').val());$('#dhcp-option-router').val($('#ip-address').val());});}
if($('#section-mpd').length){$('#audio-output-interface').change(function(){renderMSG([{'title':'Switching audio output','text':'Please wait for the config update...','icon':'fa fa-cog fa-spin','delay':5000}]);var output=$(this).val();$.ajax({type:'POST',url:'/mpd/',data:{ao:output},cache:false});});$('.manual-edit-confirm').find('.btn-primary').click(function(){$('#mpdconf_editor').removeClass('hide');$('#manual-edit-warning').addClass('hide');});}
if($('#section-debug').length){ZeroClipboard.config({swfPath:'/assets/js/vendor/ZeroClipboard.swf'});var client=new ZeroClipboard(document.getElementById('copy-to-clipboard'));client.on('ready',function(readyEvent){client.on('aftercopy',function(event){new PNotify({title:'Copied to clipboard',text:'The debug output was copied successfully in your clipboard.',icon:'fa fa-check'});});});}
if(document.location.hostname=="localhost")
$('.osk-trigger').onScreenKeyboard({'draggable':true});});$(document).on('change','.btn-file :file',function(){var input=$(this),numFiles=input.get(0).files?input.get(0).files.length:1,label=input.val().replace(/\\/g,'/').replace(/.*\//,'');input.trigger('fileselect',[numFiles,label]);});}
=======
function generateUUID(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)})}function sendCmd(a){$.ajax({type:"GET",url:"/command/?cmd="+a+"&clientUUID="+GUI.clientUUID,cache:!1})}function checkWebSocket(){return window.WebSocket?"websocket":"longpolling"}function checkWorkers(){return!!(window.Worker&&window.Blob||Modernizr.webworkers&&Modernizr.blobconstructor)}function parsePath(a){var b=a&&a.length?a.lastIndexOf("/"):0,c="";return b&&-1!==b&&(c=a.slice(0,b)),c}function timerIncrement(){$("#section-index").length&&"play"===GUI.state?idleTime+=1:idleTime=0,idleTime>SStime&&($(".tab-content").hide("slow"),$(".screen-saver-content").show("slow"),$("#menu-bottom").hide("slow"),$("#menu-top").hide("slow"),viewScreenSaver=1)}function refreshTimer(a,b,c){var d=$("#countdown-display"),e=$("#countdown-display-ss");if("Airplay"===GUI.json.actPlayer||"Snapcast"===GUI.json.actPlayer)return d.countdown("destroy"),void e.countdown("destroy");d.countdown("destroy"),d.countdown({since:"stop"!==c||void 0!==c?-a:0,compact:!0,format:"MS"}),"play"!==c&&d.countdown("pause"),e.countdown("destroy"),e.countdown({since:"stop"!==c||void 0!==c?-a:0,compact:!0,format:"MS"}),"play"!==c&&e.countdown("pause")}function refreshKnob(){window.clearInterval(GUI.currentKnob);var a=10*parseInt(GUI.json.song_percent),b=parseInt(GUI.json.time),c=parseInt(1e3/b),d=$("#time");d.val(a,!1).trigger("update"),"play"===GUI.state&&(GUI.currentKnob=setInterval(function(){a+="visible"!==GUI.visibility?c:1,d.val(a,!1).trigger("update")},b))}function timeConvert(a){var b=Math.floor(a/60);return a-=60*b,(b<10?"0"+b:b)+":"+(a<10?"0"+a:a)}function timeConvert2(a){var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60);return a=Math.floor(a-3600*b-60*c),b>0?(b<10&&(b="0"+b),b+=":"):b="",c<10&&(c="0"+c),a<10&&(a="0"+a),b+c+":"+a}function timeConvert3(a){var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60);return a=Math.floor(a-3600*b-60*c),b>0?(b<10&&(b="0"+b+"h "),b+="h "):b="",c<10&&(c="0"+c),a<10&&(a="0"+a),b+c+"m "+a+"s"}function countdownRestart(a){$("#countdown-display").countdown("destroy").countdown({since:-a,compact:!0,format:"MS"}),$("#countdown-display-ss").countdown("destroy").countdown({since:-a,compact:!0,format:"MS"})}function reset_vol_changed_local(){GUI.vol_changed_local=0}function setvol(a){GUI.volume=a,$("#volumemute").removeClass("btn-primary"),sendCmd("setvol "+a),0===GUI.vol_changed_local&&(setInterval(reset_vol_changed_local,5e3),GUI.vol_changed_local=1)}function volumeStepCalc(a){var b=0;GUI.volume=parseInt($("#volume").val());var c=function(c){b++,"up"===a?GUI.stepVolumeDelta=parseInt(GUI.volume)+b:"dn"===a&&(GUI.stepVolumeDelta=parseInt(GUI.volume)-b),$("#volume").val(GUI.stepVolumeDelta).trigger("change")};c(),GUI.stepVolumeInt=window.setInterval(function(){c()},200)}function volumeStepSet(){window.clearInterval(GUI.stepVolumeInt),setvol(GUI.stepVolumeDelta)}function customScroll(a,b,c){void 0===c&&(c=500);var d=49,e=parseInt($(window).height()/2),f=$(window).scrollTop(),g=0,h=0;"db"===a?(g=parseInt(b*d-e),h=g):"pl"===a&&(g=parseInt((b+2)*d-e),h=Math.abs(g-f),h=(g>f?"+":"-")+"="+h+"px",$("#playlist-entries").find("li").eq(b).addClass("active")),$.scrollTo(g>0?h:0,c)}function randomScrollPL(){var a=$(".playlist li").size();customScroll("pl",1+Math.floor(Math.random()*a))}function randomScrollDB(){var a=$(".database li").size();customScroll("db",1+Math.floor(Math.random()*a))}function toggleLoader(a){"close"===a?$("#loader").addClass("hide"):$("#section-dev").length?($("#loader").addClass("hide"),new PNotify({title:"Warning",text:"The loading layer (spinning arrows) points to a socket error",icon:"fa fa-exclamation-circle"})):$("#loader").removeClass("hide")}function customNotify(a){"kernelswitch"===a.custom&&(void 0!==GUI.noticeUI.kernelswitch&&GUI.noticeUI.kernelswitch.remove(),GUI.noticeUI.kernelswitch=new PNotify({title:"title"in a?a.title:"[missing title]",text:"text"in a?a.text:"[missing text]",icon:"fa fa-refresh",hide:!1,confirm:{confirm:!0,buttons:[{text:a.btntext,addClass:"btn-default btn-block  uppercase",click:function(){$.post("/settings/",{syscmd:"reboot"}),toggleLoader()}},{text:"Cancel",addClass:"hide"}]},buttons:{closer:!1,sticker:!1}}))}function renderMSG(a){var b=a[0];if("custom"in b&&null!==b.custom)return void customNotify(b);var c={title:"title"in b?b.title:"[missing title]",text:"text"in b?b.text:"[missing text]",icon:void 0===b.icon?"fa fa-check":b.icon,opacity:void 0===b.opacity?.9:b.opacity,hide:void 0===b.hide&&void 0===b.permanotice,buttons:{closer:void 0===b.permanotice,sticker:void 0===b.permanotice},delay:void 0===b.delay?8e3:b.delay,mouse_reset:!1};"permanotice"in b?void 0===GUI.noticeUI[b.permanotice]?GUI.noticeUI[b.permanotice]=new PNotify(c):"permaremove"in b?(GUI.noticeUI[b.permanotice].remove(),GUI.noticeUI[b.permanotice]=void 0):GUI.noticeUI[b.permanotice].open():new PNotify(c)}function sortOrder(a){var b=$("#"+a).index();a=parseInt(a.replace("pl-","")),sendCmd("moveid "+a+" "+b)}function loadingSpinner(a,b){"hide"===b?("db"===a&&$("#spinner-db").addClass("hide"),"pl"===a&&$("#spinner-pl").addClass("hide")):("db"===a&&$("#spinner-db").removeClass("hide"),"pl"===a&&$("#spinner-pl").removeClass("hide"))}function setPlaybackSource(){var a=GUI.libraryhome.ActivePlayer;$("#overlay-playsource-open button").text(a),$("#overlay-playsource a").addClass("inactive");var b=a.toLowerCase();$("#playsource-"+b).removeClass("inactive"),"Spotify"===a||"Airplay"===a||"Snapcast"===a?($("#volume").trigger("configure",{readOnly:!0,fgColor:"#1A242F"}).css({color:"#1A242F"}),$("#volume-knob").addClass("nomixer"),$("#volume-knob button").prop("disabled",!0),$("#single").addClass("disabled")):($("#volume").trigger("configure",{readOnly:!1,fgColor:"#0095D8"}).css({color:"#0095D8"}),$("#volume-knob").removeClass("nomixer"),$("#volume-knob button").prop("disabled",!1),$("#single").removeClass("disabled")),$("#playlist-entries").removeClass(function(a,b){return(b.match(/(^|\s)playlist-\S+/g)||[]).join(" ")}).addClass("playlist-"+b),$("#pl-manage").removeClass(function(a,b){return(b.match(/(^|\s)pl-manage-\S+/g)||[]).join(" ")}).addClass("pl-manage-"+b)}function chkKey(a){return void 0!==a&&""!==a}function renderLibraryHome(){loadingSpinner("db"),$("#database-entries").addClass("hide"),$("#db-level-up").addClass("hide"),$("#db-homeSetup").removeClass("hide").removeClass("btn-primary").addClass("btn-default"),$("#home-blocks").removeClass("hide");var a=GUI.libraryhome,b=0,c="",d='<div class="col-lg-3 col-md-4 col-sm-6">',e="</div>",f="",g="",h="Spotify"===a.ActivePlayer||"Airplay"===a.ActivePlayer||"Snapcast"===a.ActivePlayer;for(c=isLocalHost?"":'<div class="col-sm-12"><h1 class="txtmid">Browse your library</h1></div>',setPlaybackSource(),h&&(f=" inactive"),b=0;bookmark=a.bookmarks[b];b+=1)c+=d+'<div id="home-bookmark-'+bookmark.id+'" class="home-block home-bookmark'+f+'" data-path="'+bookmark.path+'"><i class="fa fa-star"></i><h3>'+bookmark.name+"</h3>bookmark</div>"+e;chkKey(a.networkMounts)&&(isLocalHost?0===a.networkMounts?c+=h?d+'<div id="home-nas" class="home-block inactive"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3></div>'+e:d+'<a class="home-block'+f+'" href="/sources/add/"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3></a>'+e:c+=d+'<div id="home-nas" class="home-block'+f+'" data-path="NAS"><i class="fa fa-sitemap"></i><h3>Network mounts ('+a.networkMounts+")</h3></div>"+e:0===a.networkMounts?c+=h?d+'<div id="home-nas" class="home-block inactive"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3>network attached storages</div>'+e:d+'<a class="home-block'+f+'" href="/sources/add/"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3>click to add some</a>'+e:c+=d+'<div id="home-nas" class="home-block'+f+'" data-path="NAS"><i class="fa fa-sitemap"></i><h3>Network mounts ('+a.networkMounts+")</h3>network attached storages</div>"+e),chkKey(a.localStorages)&&(isLocalHost?0===a.localStorages?c+="":c+=d+'<div id="home-local" class="home-block'+f+'" data-path="LocalStorage"><i class="fa fa-hdd-o"></i><h3>LocalStorage ('+a.localStorages+")</h3></div>"+e:0===a.localStorages?c+="":c+=d+'<div id="home-local" class="home-block'+f+'" data-path="LocalStorage"><i class="fa fa-hdd-o"></i><h3>LocalStorage ('+a.localStorages+")</h3>locally stored music</div>"+e),chkKey(a.USBMounts)&&(isLocalHost?0===a.USBMounts?c+=h?d+'<div id="home-usb" class="home-block inactive"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3></div>'+e:d+'<a id="home-usb" class="home-block'+f+'" href="/sources"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3></a>'+e:c+=d+'<div id="home-usb" class="home-block'+f+'" data-path="USB"><i class="fa fa-hdd-o"></i><h3>USB storage ('+a.USBMounts+")</h3></div>"+e:0===a.USBMounts?c+=h?d+'<div id="home-usb" class="home-block inactive"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3>no USB storage plugged</div>'+e:d+'<a id="home-usb" class="home-block'+f+'" href="/sources"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3>no USB storage plugged</a>'+e:c+=d+'<div id="home-usb" class="home-block'+f+'" data-path="USB"><i class="fa fa-hdd-o"></i><h3>USB storage ('+a.USBMounts+")</h3>USB attached drives</div>"+e),chkKey(a.webradio)&&(isLocalHost?0===a.webradio?c+=h?d+'<div id="home-webradio" class="home-block inactive"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3></div>'+e:d+'<a id="home-webradio" class="home-block'+f+'" href="#" data-toggle="modal" data-target="#modal-webradio-add"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3></a>'+e:c+=d+'<div id="home-webradio" class="home-block'+f+'" data-path="Webradio"><i class="fa fa-microphone"></i><h3>My Webradios ('+a.webradio+")</h3></div>"+e:0===a.webradio?c+=h?d+'<div id="home-webradio" class="home-block inactive"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3>webradio local playlists</div>'+e:d+'<a id="home-webradio" class="home-block'+f+'" href="#" data-toggle="modal" data-target="#modal-webradio-add"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3>click to add some</a>'+e:c+=d+'<div id="home-webradio" class="home-block'+f+'" data-path="Webradio"><i class="fa fa-microphone"></i><h3>My Webradios ('+a.webradio+")</h3>webradio local playlists</div>"+e),c+=isLocalHost?d+'<div id="home-albums" class="home-block'+f+'" data-path="Albums" data-browsemode="album"><i class="fa fa-dot-circle-o"></i><h3>Albums</h3></div>'+e:d+'<div id="home-albums" class="home-block'+f+'" data-path="Albums" data-browsemode="album"><i class="fa fa-dot-circle-o"></i><h3>Albums</h3>browse MPD database by album</div>'+e,c+=isLocalHost?d+'<div id="home-artists" class="home-block'+f+'" data-path="Artists" data-browsemode="artist"><i class="fa fa-users"></i><h3>Artists</h3></div>'+e:d+'<div id="home-artists" class="home-block'+f+'" data-path="Artists" data-browsemode="artist"><i class="fa fa-users"></i><h3>Artists</h3>browse MPD database by artist</div>'+e,c+=isLocalHost?d+'<div id="home-composer" class="home-block'+f+'" data-path="Composer" data-browsemode="composer"><i class="fa fa-users"></i><h3>Composer</h3></div>'+e:d+'<div id="home-composer" class="home-block'+f+'" data-path="Composer" data-browsemode="composer"><i class="fa fa-users"></i><h3>Composer</h3>browse MPD database by composer</div>'+e,c+=isLocalHost?d+'<div id="home-genre" class="home-block'+f+'" data-path="Genres" data-browsemode="genre"><i class="fa fa-tags"></i><h3>Genres</h3></div>'+e:d+'<div id="home-genre" class="home-block'+f+'" data-path="Genres" data-browsemode="genre"><i class="fa fa-tags"></i><h3>Genres</h3>browse MPD database by genre</div>'+e,chkKey(a.Spotify)&&(isLocalHost?"0"===a.Spotify||("Spotify"!==a.ActivePlayer?c+=d+'<div id="home-spotify-switch" class="home-block"><i class="fa fa-spotify"></i><h3>Spotify</h3></div>'+e:c+=d+'<div id="home-spotify" class="home-block'+g+'" data-plugin="Spotify" data-path="Spotify"><i class="fa fa-spotify"></i><h3>Spotify</div>'+e):"0"===a.Spotify||("Spotify"!==a.ActivePlayer?c+=d+'<div id="home-spotify-switch" class="home-block"><i class="fa fa-spotify"></i><h3>Spotify</h3>click to switch renderer</div>'+e:c+=d+'<div id="home-spotify" class="home-block'+g+'" data-plugin="Spotify" data-path="Spotify"><i class="fa fa-spotify"></i><h3>Spotify</h3>music for everyone</div>'+e)),chkKey(a.Snapcast)&&(c+=isLocalHost?d+'<div id="home-snapcast" class="home-block" data-plugin="Snapcast" data-path="Snapcast"><i class="fa fa-globe"></i><h3>Snapcast</h3></div>'+e:d+'<div id="home-snapcast" class="home-block" data-plugin="Snapcast" data-path="Snapcast"><i class="fa fa-globe"></i><h3>Snapcast</h3>browse local Snapcast streams</div>'+e),chkKey(a.Dirble)&&(c+=isLocalHost?d+'<div id="home-dirble" class="home-block'+f+'" data-plugin="Dirble" data-path="Dirble"><i class="fa fa-globe"></i><h3>Dirble</h3></div>'+e:d+'<div id="home-dirble" class="home-block'+f+'" data-plugin="Dirble" data-path="Dirble"><i class="fa fa-globe"></i><h3>Dirble</h3>radio stations open directory</div>'+e),c+=isLocalHost?d+'<div id="home-jamendo" class="home-block'+f+'" data-plugin="Jamendo" data-path="Jamendo"><i class="fa fa-play-circle-o"></i><h3>Jamendo<span id="home-count-jamendo"></span></h3></div>'+e:d+'<div id="home-jamendo" class="home-block'+f+'" data-plugin="Jamendo" data-path="Jamendo"><i class="fa fa-play-circle-o"></i><h3>Jamendo<span id="home-count-jamendo"></span></h3>world\'s largest platform for free music</div>'+e,c+="</div>",document.getElementById("home-blocks").innerHTML=c,loadingSpinner("db","hide"),$("span","#db-currentpath").html("")}function refreshState(){var a=GUI.state;if("play"===a?($("#play").addClass("btn-primary"),$("i","#play").removeClass("fa fa-pause").addClass("fa fa-play"),$("#stop").removeClass("btn-primary")):"pause"===a?($("#playlist-position span").html("Not playing"),$("#playlist-position-ss span").html("Not playing"),$("#play").addClass("btn-primary"),$("i","#play").removeClass("fa fa-play").addClass("fa fa-pause"),$("#stop").removeClass("btn-primary")):"stop"===a&&($("#play").removeClass("btn-primary"),$("i","#play").removeClass("fa fa-pause").addClass("fa fa-play"),$("#stop").addClass("btn-primary"),$("#section-index").length&&($("#countdown-display").countdown("destroy"),$("#countdown-display-ss").countdown("destroy")),"radio"===GUI.stream?($("#total").html("<span>&infin;</span>"),$("#total-ss").html("<span>&infin;</span>")):($("#total").html("00:00"),$("#total-ss").html("00:00")),$("#time").val(0,!1).trigger("update"),$("#format-bitrate").html("&nbsp;"),$("#format-bitrate-ss").html("&nbsp;"),$("li","#playlist-entries").removeClass("active")),$("#overlay-playsource-open button").text()!==GUI.libraryhome.ActivePlayer&&renderLibraryHome(),"stop"!==a){"radio"===GUI.stream?($("#total").html("<span>&infin;</span>"),$("#total-ss").html("<span>&infin;</span>")):($("#total").html(void 0!==GUI.json.time?timeConvert(GUI.json.time):"00:00"),$("#total-ss").html(void 0!==GUI.json.time?timeConvert(GUI.json.time):"00:00"));var b=GUI.json.audio_channels&&GUI.json.audio_sample_depth&&GUI.json.audio_sample_rate?GUI.json.audio_channels+", "+GUI.json.audio_sample_depth+" bit, "+GUI.json.audio_sample_rate+" kHz, "+GUI.json.bitrate+" kbps":"&nbsp;";$("#format-bitrate").html(b),$("#format-bitrate-ss").html(b),$("li","#playlist-entries").removeClass("active");var c=parseInt(GUI.json.song);$("#playlist-entries").find("li").eq(c).addClass("active")}GUI.json.playlistlength&&"0"!==GUI.json.playlistlength?GUI.json.song?($("#playlist-position span").html("Playlist position "+(parseInt(GUI.json.song)+1)+"/"+GUI.json.playlistlength),$("#playlist-position-ss span").html("Playlist position "+(parseInt(GUI.json.song)+1)+"/"+GUI.json.playlistlength)):($("#playlist-position span").html("Playlist position 1/"+GUI.json.playlistlength),$("#playlist-position-ss span").html("Playlist position 1/"+GUI.json.playlistlength)):($("#playlist-position span").html("Empty queue, add some music!"),$("#playlist-position-ss span").html("Empty queue, add some music!")),void 0!==GUI.json.updating_db?$("a","#open-panel-sx").html('<i class="fa fa-refresh fa-spin"></i> Updating'):$("a","#open-panel-sx").html('<i class="fa fa-music sx"></i> Library')}function updateGUI(){var a=GUI.json.volume,b=GUI.json.radioname,c=GUI.json.currentartist,d=void 0===GUI.json.currentsong?"":GUI.json.currentsong,e=GUI.json.currentalbum;if(GUI.stream=null!==b&&void 0!==b&&""!==b?"radio":"",refreshState(),$("#section-index").length){if(GUI.currentsong!==GUI.json.currentsong&&(countdownRestart(0),$("#panel-dx").hasClass("active"))){customScroll("pl",parseInt(GUI.json.song))}0===GUI.vol_changed_local&&$("#volume").val("-1"===a?100:a,!1).trigger("update"),"radio"!==GUI.stream?($("#currentartist").html(null===c||void 0===c||""===c?'<span class="notag">[no artist]</span>':c),$("#currentartist-ss").html(null===c||void 0===c||""===c?'<span class="notag">[no artist]</span>':c),null===d||d.length>35?$("#currentsong-ss")[0].style.fontSize="26px":d.length>25?$("#currentsong-ss")[0].style.fontSize="33px":$("#currentsong-ss")[0].style.fontSize="40px",$("#currentsong").html(null===d||void 0===d||""===d?'<span class="notag">[no title]</span>':d),$("#currentsong-ss").html(null===d||void 0===d||""===d?'<span class="notag">[no title]</span>':d),null===e||e.length>45?$("#currentalbum-ss")[0].style.fontSize="20px":e.length>30?$("#currentalbum-ss")[0].style.fontSize="24px":$("#currentalbum-ss")[0].style.fontSize="30px",$("#currentalbum").html(null===e||void 0===e||""===e?'<span class="notag">[no album]</span>':e),$("#currentalbum-ss").html(null===e||void 0===e||""===e?'<span class="notag">[no album]</span>':e)):($("#currentartist").html(null===c||void 0===c||""===c?b:c),$("#currentartist-ss").html(null===c||void 0===c||""===c?b:c),$("#currentsong").html(null===d||void 0===d||""===d?b:d),$("#currentsong-ss").html(null===d||void 0===d||""===d?b:d),$("#currentalbum").html('<span class="notag">streaming</span>'),$("#currentalbum-ss").html('<span class="notag">streaming</span>')),"1"===GUI.json.repeat?$("#repeat").addClass("btn-primary"):$("#repeat").removeClass("btn-primary"),"1"===GUI.json.random?$("#random").addClass("btn-primary"):$("#random").removeClass("btn-primary"),"1"===GUI.json.consume?$("#consume").addClass("btn-primary"):$("#consume").removeClass("btn-primary"),"1"===GUI.json.single?$("#single").addClass("btn-primary"):$("#single").removeClass("btn-primary"),GUI.currentsong!==d&&($("#lyric-text-overlay").html(""),"radio"!==GUI.stream&&$.ajax({url:"/lyric/",success:function(a){$("#lyric-text-overlay").html(a)},cache:!1})),GUI.currentsong=d;var f=c+" - "+e;if(GUI.old_state!==GUI.state||GUI.currentalbum!==f)if(GUI.old_state=GUI.state,$("#artist-bio-ss").html(""),$("#artist-image-ss").css("background-image",""),$("#addinfo-text-ss").html(""),$("#artist-bio-overlay").html(""),$("#artist-image-overlay").css("background-image",""),$("#addinfo-text-overlay").html(""),"radio"!==GUI.stream){var g=Math.floor(1001*Math.random());$("#cover-art").css("background-image",'url("/coverart/?v='+g+'")'),$("#cover-art-ss").css("background-image",'url("/coverart/?v='+g+'")'),$.ajax({url:"/artist_info/",success:function(a){if(""!==a){var b=jQuery.parseJSON(a);void 0!==b.artist&&""!==b.artist.bio.content?($("#artist-bio-ss").html(b.artist.bio.content.substring(0,550)+" ... "),$("#artist-bio-overlay").html(b.artist.bio.summary),$("#artist-bio-full-overlay").html(b.artist.bio.content)):($("#artist-bio-ss").html(c+", sorry, no details available "),$("#artist-bio-overlay").html(c+", sorry, no details available "),$("#artist-bio-full-overlay").html(c+", sorry, no details available ")),void 0!==b.artist&&""!==b.artist.similar.artist[0].name?($("#addinfo-text-ss").html("Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[0].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[1].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[2].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[3].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[4].name),$("#addinfo-text-overlay").html("Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[0].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[1].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[2].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[3].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[4].name+"<br>&nbsp;<br>&nbsp;")):($("#addinfo-text-ss").html(""),$("#addinfo-text-overlay").html("")),void 0!==b.artist&&""!==b.artist.image[2]?($("#artist-image-ss").css("background-image",'url("'+b.artist.image[2]["#text"]+'")'),$("#artist-image-overlay").css("background-image",'url("'+b.artist.image[2]["#text"]+'")')):($("#artist-image-ss").css("background-image",'url("assets/img/unkown.png")'),$("#artist-image-overlay").css("background-image",'url("assets/img/unkown.png")'))}},cache:!1})}else{var g=Math.floor(1001*Math.random());$.ajax({url:"/artist_info/",success:function(a){var b=jQuery.parseJSON(a);void 0!==b.artist&&""!==b.artist.bio.content&&($("#artist-bio-ss").html(b.artist.bio.content.substring(0,1e3)+" ... "),$("#addinfo-text-ss").html("Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[0].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[1].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[2].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[3].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+b.artist.similar.artist[4].name),$("#artist-image-ss").css("background-image",'url("'+b.artist.image[2]["#text"]+'")'))},cache:!1}),$("#cover-art").css("background-image",'url("assets/img/cover-radio.jpg")'),$("#cover-art-ss").css("background-image",'url("assets/img/cover-radio.jpg")')}GUI.currentalbum=f}}function getPlaylistPlain(a){var b,c,d=parseInt(GUI.json.song)+1,e=GUI.json.state,f="",g="",h="",i="",j="",k="",l="",m="",n="",o="",p="",q=0,r=0,s=0,t=a.split("\n"),u=[];for(b=0;c=t[b];b+=1)u=c.split(/: (.+)?/),"Time"===u[0]?g=parseInt(u[1]):"Artist"===u[0]?h=u[1]:"Title"===u[0]?j=u[1]:"Name"===u[0]?k=u[1]:"Album"===u[0]?i=u[1]:"file"===u[0]?l=u[1]:"Id"===u[0]&&(o=u[1],""===j||""===i?(n=parsePath(l),m=l.split("/").pop(),j=m,p=""===h?"path: "+n:h):p=h+" - "+i,""!==k?(j='<i class="fa fa-microphone"></i>'+k,p=l,q=""):(q="<span>"+timeConvert2(g)+"</span>",r+=g),s++,f+='<li id="pl-'+o+'"'+("stop"!==e&&s===d?' class="active"':"")+'><i class="fa fa-times-circle pl-action" title="Remove song from playlist"></i><span class="sn">'+j+q+'</span><span class="bl">'+p+"</span></li>",g="",h="",i="",j="",k="");$(".playlist").addClass("hide"),$("#playlist-entries").removeClass("hide");var v=document.getElementById("playlist-entries");v&&(v.innerHTML=f),$("#pl-filter-results").addClass("hide").html(""),$("#pl-filter").val(""),$("#pl-manage").removeClass("hide"),$("#pl-count").removeClass("hide").html(s+(1!==s?" entries":" entry")+" "+timeConvert3(r)+" total playtime")}function getPlaylistCmd(){loadingSpinner("pl"),$.ajax({url:"/db/?cmd=playlist",success:function(a){if(a.length>4){$(".playlist").addClass("hide"),$("#playlist-entries").removeClass("hide"),getPlaylistPlain(a);var b=parseInt(GUI.json.song);$("#panel-dx").hasClass("active")&&GUI.currentsong!==GUI.json.currentsong&&customScroll("pl",b,200)}else $(".playlist").addClass("hide"),$("#playlist-warning").removeClass("hide"),$("#pl-filter-results").addClass("hide").html(""),$("#pl-count").removeClass("hide").html("0 entries");loadingSpinner("pl","hide")},cache:!1})}function getPlaylist(a){if(data=a[0],data.length>4){$(".playlist").addClass("hide"),$("#playlist-entries").removeClass("hide"),getPlaylistPlain(data);var b=parseInt(GUI.json.song);$("#panel-dx").hasClass("active")&&GUI.currentsong!==GUI.json.currentsong&&customScroll("pl",b,200)}else $(".playlist").addClass("hide"),$("#playlist-warning").removeClass("hide"),$("#pl-filter-results").addClass("hide").html(""),$("#pl-count").removeClass("hide").html("0 entries");loadingSpinner("pl","hide")}function renderUI(a){if(toggleLoader("close"),GUI.json=a[0],GUI.state=GUI.json.state,updateGUI(),$("#section-index").length){var b=""!==GUI.json.elapsed&&void 0!==GUI.json.elapsed?GUI.json.elapsed:0,c=""!==GUI.json.time&&void 0!==GUI.json.time&&null!==GUI.json.time?GUI.json.time:0;refreshTimer(parseInt(b),parseInt(c),GUI.json.state),"radio"!==GUI.stream?refreshKnob():$("#time").val(0,!1).trigger("update"),GUI.json.playlist!==GUI.playlist&&(getPlaylistCmd(),GUI.playlist=GUI.json.playlist)}}function renderPlaylists(a){var b,c,d="",e="",f=a.split("\n"),g=[];for(b=0;c=f[b];b+=1)g=c.split(": "),"playlist"===g[0]&&(e=g[1],d+='<li class="pl-folder" data-path="'+e+'"><i class="fa fa-bars pl-action" data-target="#context-menu-playlist" data-toggle="context" title="Actions"></i><span><i class="fa fa-list-ol"></i>'+e+"</span></li>",e="");document.getElementById("playlist-entries").innerHTML="",$(".playlist").addClass("hide"),$("#pl-manage").addClass("hide"),$("#pl-count").addClass("hide"),$("#pl-filter-results").removeClass("hide").addClass("back-to-queue").html('<i class="fa fa-arrow-left sx"></i> to queue'),$("#pl-currentpath").removeClass("hide"),$("#pl-editor").removeClass("hide"),document.getElementById("pl-editor").innerHTML=d,loadingSpinner("pl","hide")}function getPlaylists(){loadingSpinner("pl"),$.ajax({url:"/command/?cmd=listplaylists",success:function(a){renderPlaylists(a)},cache:!1})}function updatePlaylistDropdown(a){var b,c,d=a.split("\n"),e=[],f="";for(b=0;c=d[b];b+=1)e=c.split(": "),"playlist"===e[0]&&(f+='<option value="'+e[1]+'" />');document.getElementById("pl-list").innerHTML=f,loadingSpinner("pl","hide")}function getPlaylistsDropdown(){loadingSpinner("pl"),$.ajax({url:"/command/?cmd=listplaylists",success:function(a){updatePlaylistDropdown(a)},cache:!1})}function parseResponse(a){var b=a.inputArr||"",c=a.respType||"",d=a.i||0,e=a.inpath||"",f=a.querytype||"",g="";switch(c){case"playlist":break;case"db":"file"===GUI.browsemode?(""===e&&void 0!==b.file&&(e=parsePath(b.file)),void 0!==b.file||"Webradio"===e?(g='<li id="db-'+(d+1)+'" data-path="',void 0!==b.Title?(g+=b.file,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',g+=b.Title+" <span>"+timeConvert(b.Time)+"</span></span>",g+=' <span class="bl">',g+=b.Artist,g+=" - ",g+=b.Album):"Webradio"!==e?(g+=b.file,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',g+=b.file.replace(e+"/","")+" <span>"+timeConvert(b.Time)+"</span></span>",g+='<span class="bl">',g+=" path: ",g+=e):(g+=b.playlist,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-webradio"></i><i class="fa fa-microphone db-icon db-radio"></i>',g+='<span class="sn">'+b.playlist.replace(e+"/","").replace("."+b.fileext,""),g+='</span><span class="bl">webradio'),g+="</span></li>"):void 0!==b.playlist?"cue"===b.fileext&&(g='<li id="db-'+(d+1)+'" data-path="',g+=b.playlist,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-file-text db-icon"></i><span class="sn">',g+=b.playlist.replace(e+"/","")+" <span>[CUE file]</span></span>",g+='<span class="bl">',g+=" path: ",g+=e,g+="</span></li>"):(g='<li id="db-'+(d+1)+'" class="db-folder" data-path="',g+=b.directory,g+=""!==e?'"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu"></i><span><i class="fa fa-folder-open"></i>':'"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-root"></i><i class="fa fa-hdd-o icon-root"></i><span>',g+=b.directory.replace(e+"/",""),g+="</span></li>")):"album"===GUI.browsemode||"albumfilter"===GUI.browsemode?void 0!==b.file?(g='<li id="db-'+(d+1)+'" data-path="',g+=b.file,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',g+=b.Title+" <span>"+timeConvert(b.Time)+"</span></span>",g+=' <span class="bl">',g+=b.Artist,g+=" - ",g+=b.Album,g+="</span></li>"):""!==b.album&&(g='<li id="db-'+(d+1)+'" class="db-folder db-album" data-path="',g+=b.album.replace(/\"/g,"&quot;"),g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>',g+=b.album,g+="</span></li>"):"artist"===GUI.browsemode?void 0!==b.album?(g='<li id="db-'+(d+1)+'" class="db-folder db-album" data-path="',g+=b.album,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>',g+=""!==b.album?b.album:"Unknown album",g+="</span></li>"):""!==b.artist&&(g='<li id="db-'+(d+1)+'" class="db-folder db-artist" data-path="',g+=b.artist,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-user"></i>',g+=b.artist,g+="</span></li>"):"composer"===GUI.browsemode?void 0!==b.file?(g='<li id="db-'+(d+1)+'" data-path="',g+=b.file,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',g+=b.Title+" <span>"+timeConvert(b.Time)+"</span></span>",g+=' <span class="bl">',g+=b.Artist,g+=" - ",g+=b.Album,g+="</span></li>"):""!==b.composer&&(g='<li id="db-'+(d+1)+'" class="db-folder db-composer" data-path="',g+=b.composer,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-composer"></i><span><i class="fa fa-user"></i>',g+=b.composer,g+="</span></li>"):"genre"===GUI.browsemode&&(void 0!==b.artist?(g='<li id="db-'+(d+1)+'" class="db-folder db-artist" data-path="',g+=b.artist,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-dot-circle-o"></i>',g+=""!==b.artist?b.artist:"Unknown artist",g+="</span></li>"):""!==b.genre&&(g='<li id="db-'+(d+1)+'" class="db-folder db-genre" data-path="',g+=b.genre,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-genre"></i><span><i class="fa fa-tags"></i>',g+=b.genre,g+="</span></li>"));break;case"Spotify":""===f?(g='<li id="db-'+(d+1)+'" class="db-spotify db-folder" data-path="',g+=b.index,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify-pl"></i><span><i class="fa fa-folder-open"></i>',g+=""!==b.name?b.name:"Favorites",g+=" (",g+=b.tracks,g+=")</span></li>"):"tracks"===f&&(g='<li id="db-'+(d+1)+'" class="db-spotify" data-path="',g+=b.index,g+='" data-plid="',g+=e,g+='" data-type="spotify-track"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify"></i><i class="fa fa-spotify db-icon"></i><span class="sn">',g+=b.title+" <span>"+timeConvert(b.duration/1e3)+"</span></span>",g+=' <span class="bl">',g+=b.artist,g+=" - ",g+=b.album,g+="</span></li>");break;case"Dirble":if(""===f||"childs"===f){g='<li id="db-'+(d+1)+'" class="db-dirble db-folder'+("childs"===f?" db-dirble-child":"")+'" data-path="',g+=b.id,g+='"><span><i class="fa fa-folder-open"></i>',g+=b.title,g+="</span></li>"}else if("search"===f||"stations"===f||"childs-stations"===f){if(0===b.streams.length)break;g='<li id="db-'+(d+1)+'" class="db-dirble db-radio" data-path="',g+=b.name+" | "+b.streams[0].stream,g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-dirble"></i><i class="fa fa-microphone db-icon"></i>',g+='<span class="sn">'+b.name+"<span>("+b.country+")</span></span>",g+='<span class="bl">',g+=b.website?b.website:"-no website-",g+="</span></li>"}break;case"Snapcast":""===f&&(g='<li id="db-'+(d+1)+'" class="db-snapcast db-radio" data-path="',g+=b.name,g+='"><i class="fa fa-wifi db-icon"></i>',g+='<span class="sn">'+b.name,g+='</span><span class="bl">',g+=b.ip,g+="</span></li>");break;case"Jamendo":g='<li id="db-'+(d+1)+'" class="db-jamendo db-folder" data-path="',g+=b.stream,g+='"><img class="jamendo-cover" src="/tun/'+b.image+'" alt=""><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i>',g+=b.dispname+"</div></li>"}return g}function populateDB(a){var b=a.data||"",c=a.path||"",d=a.uplevel||0,e=a.keyword||"",f=a.plugin||"",g=a.querytype||"",h=a.args||"",i="",j=0,k=[];if(console.log(JSON.stringify(b)),""!==f){if("Spotify"===f){for($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),c&&(GUI.currentpath=c),document.getElementById("database-entries").innerHTML="",b="tracks"===g?b.tracks:b.playlists,b.sort(function(a,b){if("Spotify"===c&&""===g)nameA=a.hasOwnProperty("name")?a.name.toLowerCase():"",nameB=b.hasOwnProperty("name")?b.name.toLowerCase():"";else{if("tracks"!==g)return 0;nameA=a.hasOwnProperty("title")?a.title.toLowerCase():"",nameB=b.hasOwnProperty("title")?b.title.toLowerCase():""}return nameA.localeCompare(nameB)}),j=0;k=b[j];j+=1)i+=parseResponse({inputArr:k,respType:"Spotify",i:j,querytype:g,inpath:h});document.getElementById("database-entries").innerHTML=i}if("Dirble"===f){for($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),c&&(GUI.currentpath="search"===g?"Dirble":c),"childs-stations"===g?i=document.getElementById("database-entries").innerHTML:document.getElementById("database-entries").innerHTML="",b.sort(function(a,b){if(""===g||"childs"===g||"categories"===g)nameA=a.hasOwnProperty("title")?a.title.toLowerCase():"",nameB=b.hasOwnProperty("title")?b.title.toLowerCase():"";else{if("childs-stations"!==g&&"stations"!==g)return 0;nameA=a.hasOwnProperty("name")?a.name.toLowerCase():"",nameB=b.hasOwnProperty("name")?b.name.toLowerCase():""}return nameA.localeCompare(nameB)}),j=0;k=b[j];j+=1)i+=parseResponse({inputArr:k,respType:"Dirble",i:j,querytype:g});document.getElementById("database-entries").innerHTML=i}if("Snapcast"===f){for($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),c&&(GUI.currentpath="search"===g?"Snapcast":c),document.getElementById("database-entries").innerHTML="",b.sort(function(a,b){return nameA=a.hasOwnProperty("name")?a.name.toLowerCase():"",nameB=b.hasOwnProperty("name")?b.name.toLowerCase():"",nameA.localeCompare(nameB)}),j=0;k=b[j];j+=1)i+=parseResponse({inputArr:k,respType:"Snapcast",i:j,querytype:g});document.getElementById("database-entries").innerHTML=i}if("Jamendo"===f){for($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),c&&(GUI.currentpath=c),document.getElementById("database-entries").innerHTML="",b.sort(function(a,b){return"Jamendo"!==c||""!==g?0:(nameA=a.hasOwnProperty("dispname")?a.dispname.toLowerCase():"",nameB=b.hasOwnProperty("dispname")?b.dispname.toLowerCase():"",nameA.localeCompare(nameB))}),j=0;k=b[j];j+=1)i+=parseResponse({inputArr:k,respType:"Jamendo",i:j,querytype:g});document.getElementById("database-entries").innerHTML=i}}else{if(""===c&&""===e)return void renderLibraryHome();if($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),c&&(GUI.currentpath=c),document.getElementById("database-entries").innerHTML="",""!==e){var l=b.length?b.length:"0",m=1===b.length?"":"s";$("#db-level-up").addClass("hide"),$("#db-search-results").removeClass("hide").html('<i class="fa fa-times sx"></i><span class="visible-xs-inline">back</span><span class="hidden-xs">'+l+" result"+m+' for "<span class="keyword">'+e+'</span>"</span>')}for(b.sort(function(a,b){if("Artists"===c||"AlbumArtists"===c||"Various Artists"===c)nameA=a.hasOwnProperty("artist")?a.artist.toLowerCase():"",nameB=b.hasOwnProperty("artist")?b.artist.toLowerCase():"";else if("Albums"===c)nameA=a.hasOwnProperty("album")?a.album.toLowerCase():"",nameB=b.hasOwnProperty("album")?b.album.toLowerCase():"";else if("Webradio"===c)nameA=a.hasOwnProperty("playlist")?a.playlist.toLowerCase():"",nameB=b.hasOwnProperty("playlist")?b.playlist.toLowerCase():"";else if("Genres"===c)nameA=a.hasOwnProperty("genre")?a.genre.toLowerCase():"",nameB=b.hasOwnProperty("genre")?b.genre.toLowerCase():"";else{if(!c)return 0;nameA=a.hasOwnProperty("directory")?a.directory.toLowerCase():"",nameB=b.hasOwnProperty("directory")?b.directory.toLowerCase():""}return nameA.localeCompare(nameB)}),"Webradio"===c&&(i+='<li id="webradio-add" class="db-webradio-add"><i class="fa fa-plus-circle db-icon"></i><span class="sn"><em>add new</em></span><span class="bl">add a webradio to your library</span></li>'),j=0;k=b[j];j+=1)i+=parseResponse({inputArr:k,respType:"db",i:j,inpath:c});document.getElementById("database-entries").innerHTML=i}var n=$("span","#db-currentpath");if("album"===GUI.browsemode?"Albums"===c?n.html(c):n.html("Albums/"+c):"artist"===GUI.browsemode?"Artists"===c?n.html(c):n.html("Artists/"+c):"composer"===GUI.browsemode?"Composer"===c?n.html(c):n.html("Composer/"+c):"genre"===GUI.browsemode?"Genres"===c?n.html(c):n.html("Genres/"+c):n.html(c),$("#db-homeSetup").addClass("hide"),d){var o=GUI.currentDBpos[GUI.currentDBpos[10]];$("#db-"+o).addClass("active"),customScroll("db",o,0)}else customScroll("db",0,0);"childs"!=g&&loadingSpinner("db","hide")}function getDB(a){var b=a.cmd||"browse",c=a.path||"",d=a.browsemode||"file",e=a.uplevel||"",f=a.plugin||"",g=a.querytype||"",h=a.args||"";if(loadingSpinner("db"),GUI.browsemode=d,""!==f)"Spotify"===f?$.post("/db/?cmd=spotify",{plid:h},function(a){populateDB({data:a,path:c,plugin:f,querytype:g,uplevel:e,args:h})},"json"):"Dirble"===f?"childs"===g?($.post("/db/?cmd=dirble",{querytype:"childs",args:h},function(a){populateDB({data:a,path:c,plugin:f,querytype:"childs",uplevel:e})},"json"),$.post("/db/?cmd=dirble",{querytype:"childs-stations",args:h},function(a){populateDB({data:a,path:c,plugin:f,querytype:"childs-stations",uplevel:e})},"json")):$.post("/db/?cmd=dirble",{querytype:""===g?"categories":g,args:h},function(a){populateDB({data:a,path:c,plugin:f,querytype:g,uplevel:e})},"json"):"Snapcast"===f?$.post("/db/?cmd=snapcast",null,function(a){populateDB({data:a,path:c,plugin:f})},"json"):"Jamendo"===f&&$.post("/db/?cmd=jamendo",{querytype:""===g?"radio":g,args:h},function(a){populateDB({data:a.results,path:c,plugin:f,querytype:g})},"json");else if("search"===b){var i=$("#db-search-keyword").val();c.match(/Dirble/)?$.post("/db/?cmd=dirble",{querytype:"search",args:i},function(a){populateDB({data:a,path:c,plugin:"Dirble",querytype:"search",uplevel:e})},"json"):$.post("/db/?querytype="+GUI.browsemode+"&cmd=search",{query:i},function(a){populateDB({data:a,path:c,uplevel:e,keyword:i})},"json")}else"browse"===b?$.post("/db/?cmd=browse",{path:c,browsemode:GUI.browsemode},function(a){populateDB({data:a,path:c,uplevel:e})},"json"):(loadingSpinner("db","hide"),$.post("/db/?cmd="+b,{path:c,querytype:g},function(a){},"json"))}function onreleaseKnob(a){if("stop"!==GUI.state&&""!==GUI.state)if("radio"!==GUI.stream){window.clearInterval(GUI.currentKnob);var b=Math.floor(a*parseInt(GUI.json.time)/1e3);sendCmd("seek "+GUI.json.song+" "+b),$("#time").val(a),$("#countdown-display").countdown("destroy"),$("#countdown-display-ss").countdown("destroy"),$("#countdown-display").countdown({since:-b,compact:!0,format:"MS"}),$("#countdown-display-ss").countdown({since:-b,compact:!0,format:"MS"})}else $("#time").val(0).trigger("change")}function commandButton(a){var b,c=a.data("cmd");if("stop"===c)a.addClass("btn-primary"),$("#play").removeClass("btn-primary"),$("#section-index").length&&(refreshTimer(0,0,"stop"),window.clearInterval(GUI.currentKnob),$(".playlist").find("li").removeClass("active"),$("#total").html("00:00"),$("#total-ss").html("00:00"));else{if("play"===c){var d=GUI.state;return"play"===d?(b="pause",$("#section-index").length&&($("#countdown-display").countdown("pause"),$("#countdown-display-ss").countdown("pause"))):"pause"===d?(b="play",$("#section-index").length&&($("#countdown-display").countdown("resume"),$("#countdown-display-ss").countdown("resume"))):"stop"===d&&(b="play",$("#section-index").length&&($("#countdown-display").countdown({since:0,compact:!0,format:"MS"}),$("#countdown-display-ss").countdown({since:0,compact:!0,format:"MS"}))),window.clearInterval(GUI.currentKnob),void sendCmd(b)}if("previous"===c||"next"===c)$("#section-index").length&&($("#countdown-display").countdown("pause"),$("#countdown-display-ss").countdown("pause"),window.clearInterval(GUI.currentKnob));else if(a.hasClass("btn-volume")){var e,f=parseInt($("#volume").val());return"volumedn"===c&&parseInt(GUI.volume)>0?(e=parseInt(GUI.volume)-1,GUI.volume=e,$("#volumemute").removeClass("btn-primary")):"volumeup"===c&&parseInt(GUI.volume)<100?(e=parseInt(GUI.volume)+1,GUI.volume=e,$("#volumemute").removeClass("btn-primary")):"volumemute"===c&&(0!==f?(GUI.volume=f,a.addClass("btn-primary"),e=0):(a.removeClass("btn-primary"),e=GUI.volume)),void(e>=0&&e<=100&&(sendCmd("setvol "+e),$("#volume").val(e,!1).trigger("update")))}}a.hasClass("btn-toggle")?(b=c+(a.hasClass("btn-primary")?" 0":" 1"),a.toggleClass("btn-primary")):b=c,sendCmd(b)}function libraryHome(a){var b=GUI.libraryhome.ActivePlayer;GUI.libraryhome=a[0],GUI.libraryhome.ActivePlayer!==b&&(GUI.forceGUIupdate=!0),GUI.libraryhome.clientUUID===GUI.clientUUID&&"Dirble"!==GUI.plugin&&"Snapcast"!==GUI.plugin&&"Webradio"!==GUI.currentpath&&renderLibraryHome(),"Webradio"===GUI.currentpath&&getDB({path:"Webradio",uplevel:0}),!0===GUI.forceGUIupdate&&(GUI.forceGUIupdate=!1,renderLibraryHome())}function listWLANs(a){var b="",c="",d="",e=a[0];$.each(e,function(a){b+='<p><a href="/network/wlan/'+e[a].nic+"/"+e[a].ESSID+'" class="btn btn-lg btn-default btn-block" title="See network properties">',0!==e[a].connected&&(b+='<i class="fa fa-check green sx"></i>'),1===e[a].storedprofile&&"on"===e[a].encryption?b+='<i class="fa fa-lock sx"></i>':"on"===e[a].encryption?b+='<i class="fa fa-rss fa-wifi"></i><i class="fa fa-lock sx"></i>':1!==e[a].storedprofile&&(b+='<i class="fa fa-rss fa-wifi sx"></i>'),b+="<strong>"+e[a].ESSID+"</strong></a></p>","scan"===e[a].origin&&(c+=b),1===e[a].storedprofile&&(d+=b),b=""}),""===c&&(c='<p><a class="btn btn-lg btn-default btn-block" href="#"><i class="fa fa-cog fa-spin sx"></i>scanning for networks...</a></p>'),document.getElementById("wifiNetworks").innerHTML=c,document.getElementById("wifiStored").innerHTML=d,$.ajax({url:"/command/?cmd=wifiscan",cache:!1})}function nicsDetails(a){var b="",c=a[0];$.each(c,function(a){a===$("#nic-details").data("name")&&(b+="<tr><th>Name:</th><td><strong>"+a+"<strong></td></tr>",b+="<tr><th>Type:</th><td>wireless</td></tr>",null===c[a].currentssid?b+='<tr><th>Status:</th><td><i class="fa fa-times red sx"></i>no network connected</td></tr>':(b+='<tr><th>Status:</th><td><i class="fa fa-check green sx"></i>connected</td></tr>',b+="<tr><th>Associated SSID:</th><td><strong>"+c[a].currentssid+"</strong></td></tr>"),b+="<tr><th>Assigned IP:</th><td>"+(null!==c[a].ip?"<strong>"+c[a].ip+"</strong>":"none")+"</td></tr>",b+="<tr><th>Speed:</th><td>"+(null!==c[a].speed?c[a].speed:"unknown")+"</td></tr>",null!==c[a].currentssid&&(b+="<tr><th>Netmask:</th><td>"+c[a].netmask+"</td></tr>",b+="<tr><th>Gateway:</th><td>"+c[a].gw+"</td></tr>",b+="<tr><th>DNS1:</th><td>"+c[a].dns1+"</td></tr>",b+="<tr><th>DNS2:</th><td>"+c[a].dns2+"</td></tr>"))}),$("#nic-details tbody").html(b)}function playbackChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode,reconnectOnChannelUnavailableInterval:5e3});a.onmessage=renderUI,a.onstatuschange=function(a){2===a?($("#loader").addClass("hide"),sendCmd("renderui")):0===a&&toggleLoader()},a.addChannel("playback"),a.connect()}function queueChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=getPlaylist,a.addChannel("queue"),a.connect()}function libraryChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=libraryHome,a.addChannel("library"),a.connect()}function notifyChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=renderMSG,a.addChannel("notify"),a.connect()}function wlansChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=listWLANs,a.addChannel("wlans"),a.connect(),$.ajax({url:"/command/?cmd=wifiscan",cache:!1})}function nicsChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=nicsDetails,a.addChannel("nics"),a.connect()}function overlayTrigger(a){function b(){if(c.hasClass("open")){c.removeClass("open"),c.addClass("closed")}else if(c.hasClass("closed")&&(c.addClass("open"),"#overlay-social"===a)){var b="https://twitter.com/home?status=Listening+to+"+GUI.json.currentsong.replace(/\s+/g,"+")+"+by+"+GUI.json.currentartist.replace(/\s+/g,"+")+"+on+%40RuneAudio+http%3A%2F%2Fwww.runeaudio.com%2F+%23nowplaying",d="https://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.runeaudio.com%2F&display=popup",e="https://plus.google.com/share?url=http%3A%2F%2Fwww.runeaudio.com%2F";$("#urlTwitter").attr("href",b),$("#urlFacebook").attr("href",d),$("#urlGooglePlus").attr("href",e)}}var c=$(a),d=$(a+"-open"),e=$(a+"-close");transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},d.click(function(){b()}),e.click(function(){b()})}function getHiddenProp(){var a=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0;b<a.length;b++)if(a[b]+"Hidden"in document)return a[b]+"Hidden";return null}function isHidden(){var a=getHiddenProp();return!!a&&document[a]}function visChange(){isHidden()?GUI.visibility="hidden":GUI.visibility="visible"}var GUI={DBentry:["","",""],DBupdate:0,browsemode:"file",checkvol:0,currentDBpos:[0,0,0,0,0,0,0,0,0,0,0],currentDBpath:["","","","","","","","","","",""],currentalbum:null,currentknob:null,currentpath:"",currentsong:null,json:0,libraryhome:"",forceGUIupdate:!1,maxvol:100,minvol:0,mode:"websocket",noticeUI:{},playlist:null,plugin:"",state:"",old_state:"none",stepVolumeDelta:0,stepVolumeInt:0,stream:"",visibility:"visible",vol_changed_local:0,volume:null,clientUUID:null},idleTime=0,viewScreenSaver=0,widthScreenSaver=0,isLocalHost=0,SStime=-1;$(document).ready(function(){if(GUI.clientUUID=generateUUID(),$("#section-index").length){if("localhost"===location.hostname||"127.0.0.1"===location.hostname?(isLocalHost=1,SStime=localSStime):(isLocalHost=0,SStime=remoteSStime),SStime>=0){setInterval(timerIncrement,1e3)}$(this).on("mousemove click keypress",function(a){idleTime=0,viewScreenSaver&&($(".tab-content").show("slow"),$(".screen-saver-content").hide("slow"),$("#menu-bottom").show("slow"),$("#menu-top").show("slow"),viewScreenSaver=0)})}}),$("#section-index").length?jQuery(document).ready(function(a){"use strict";function b(){clearInterval(f),g-=10,g<50&&(g=50),f=setInterval(b,g);var c;parseInt(a("#volume").val());parseInt(GUI.volume)>0&&(c=parseInt(GUI.volume)-1,GUI.volume=c,a("#volumemute").removeClass("btn-primary")),c>=0&&c<=100&&(setvol(c),a("#volume").val(c,!1).trigger("update"))}function c(){clearInterval(f),g-=10,g<50&&(g=50),f=setInterval(c,g);var b;parseInt(a("#volume").val());parseInt(GUI.volume)<100&&(b=parseInt(GUI.volume)+1,GUI.volume=b,a("#volumemute").removeClass("btn-primary")),b>=0&&b<=100&&(setvol(b),a("#volume").val(b,!1).trigger("update"))}GUI.mode=checkWebSocket(),playbackChannel(),libraryChannel(),PNotify.prototype.options.styling="fontawesome",PNotify.prototype.options.stack.dir1="up",PNotify.prototype.options.stack.dir2="left",PNotify.prototype.options.stack.firstpos1=90,PNotify.prototype.options.stack.firstpos2=50,PNotify.prototype.options.stack.spacing1=10,PNotify.prototype.options.stack.spacing2=10,notifyChannel();var d=getHiddenProp();if(d){var e=d.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(e,visChange)}a(".btn-cmd").click(function(){commandButton(a(this))});var f,g;a("#volumedn").on("mouseleave mouseout mouseup",function(){return clearInterval(f),!1}),a("#volumedn").mousedown(function(){return g=300,f=setInterval(b,g+200),!1}),a("#volumeup").on("mouseleave mouseout mouseup",function(){return clearInterval(f),!1}),a("#volumeup").mousedown(function(){return g=300,f=setInterval(c,g+200),!1}),a("#countdown-display").click(function(){sendCmd("pause")}),a("#total").click(function(){sendCmd("pause")}),a("#random").click(function(){"pl-ashuffle-stop"===a("#random").attr("data-cmd")&&(a.post("/db/?cmd=pl-ashuffle-stop",""),a("#random").attr("data-cmd","random"),a("#random").attr("title","Random"),a("#random").removeClass("btn-primary"))}),a("#time").knob({inline:!1,change:function(b){"stop"!==GUI.state?window.clearInterval(GUI.currentKnob):a("#time").val(0).trigger("change")},release:function(a){onreleaseKnob(a)}});var h=a("#volume").data("dynamic");a("#volume").knob({inline:!1,change:function(b){var c=parseInt(b);return c>GUI.maxvol-4&&GUI.checkvol<GUI.minvol+5?(a("#volume").val(0),h&&a(document).mouseup(),!1):c<GUI.minvol+4&&GUI.checkvol>GUI.maxvol-5?(a("#volume").val(100),h&&a(document).mouseup(),!1):(h&&c!==GUI.volume&&setvol(c),void(GUI.checkvol=c))},release:function(a){var b=parseInt(a);h||b===GUI.volume||setvol(b)},draw:function(){if("tron"===this.$.data("skin")){this.cursorExt=.05;var a,b=this.arc(this.cv);return this.g.lineWidth=this.lineWidth,this.o.displayPrevious&&(a=this.arc(this.v),this.g.beginPath(),this.g.strokeStyle=this.pColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,a.s,a.e,a.d),this.g.stroke()),this.g.beginPath(),this.g.strokeStyle=1?this.o.fgColor:this.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,b.s,b.e,b.d),this.g.stroke(),this.g.lineWidth=2,this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+13+this.lineWidth,0,2*Math.PI,!1),this.g.stroke(),!1}}}),a("#playlist-entries").on("click","li",function(b){var c="";if(a(b.target).hasClass("pl-action")){b.preventDefault();var d=a(this).attr("id");d=parseInt(d.replace("pl-","")),c="deleteid "+d,sendCmd(c)}else c="play "+a("li","#playlist-entries").index(this),sendCmd(c),a("li.active","#playlist-entries").removeClass("active"),a(this).addClass("active")}),a("a","#open-panel-dx").click(function(){a("#open-panel-dx").hasClass("active")&&(customScroll("pl",parseInt(GUI.json.song),500),a("#pl-filter-results").hasClass("hide")||a("#pl-filter-results").click())}).on("shown.bs.tab",function(a){customScroll("pl",parseInt(GUI.json.song),0)}),a("#open-library").click(function(){a("#open-panel-dx").removeClass("active"),a("#open-panel-sx").addClass("active")}),a("#pl-filter").keyup(function(){a.scrollTo(0,500);var b=a(this).val(),c=0;a("li","#playlist-entries").each(function(){var d=a(this);d.text().search(new RegExp(b,"i"))<0?d.hide():(d.show(),c++)});var d=1===c?"":"s";""!==b?(a("#pl-count").addClass("hide"),a("#pl-filter-results").removeClass("hide").html('<i class="fa fa-times sx"></i><span class="visible-xs-inline">back</span><span class="hidden-xs">'+ +c+" result"+d+' for "<span class="keyword">'+b+'</span>"</span>')):(a("#pl-count").removeClass("hide"),a("#pl-filter-results").addClass("hide").html(""))}),a("#pl-filter-results").click(function(){a(this).addClass("hide"),a("#pl-count").removeClass("hide"),a(this).hasClass("back-to-queue")?(a(".playlist").addClass("hide"),getPlaylistCmd(),a("#pl-currentpath").addClass("hide"),a("#pl-manage").removeClass("hide")):(a("li","#playlist-entries").each(function(){a(this).show()}),a("#pl-currentpath").removeClass("hide"),a("#pl-filter").val("")),customScroll("pl",parseInt(GUI.json.song),500)}),a("#pl-manage-list").click(function(){getPlaylists()}),a("#modal-pl-save-btn").click(function(){sendCmd('save "'+a("#pl-save-name").val()+'"')}),a("#pl-editor").on("click",".pl-action",function(b){b.preventDefault();var c=a(this).parent().attr("data-path");GUI.DBentry[0]=c}),a("#pl-rename-button").click(function(){sendCmd('rename "'+a("#pl-rename-oldname").text()+'" "'+a("#pl-rename-name").val()+'"'),getPlaylists()}),a("#pl-manage-save").click(function(){getPlaylistsDropdown()});var i=document.getElementById("playlist-entries");new Sortable(i,{ghostClass:"sortable-ghost",onUpdate:function(a){sortOrder(a.item.getAttribute("id"))}}),a("a","#open-panel-sx").click(function(){a("#open-panel-sx").hasClass("active")&&customScroll("pl",parseInt(GUI.json.song),500)}).on("shown.bs.tab",function(a){customScroll("db",GUI.currentDBpos[GUI.currentDBpos[10]],0)}),a("#home-blocks").on("click",".home-block",function(b){if(a(this).hasClass("inactive"))a("#overlay-playsource-open").trigger("click");else if(a(this).is("#home-spotify-switch"))a("#overlay-playsource-open").trigger("click");else if(a(b.target).is("span.block-remove")){var c=a(this).attr("id");c=c.replace("home-bookmark-","");var d=a(this).find("h3").text();a.post("/db/?cmd=bookmark",{id:c,name:d})}else++GUI.currentDBpos[10],getDB({browsemode:a(this).data("browsemode"),path:a(this).data("path"),uplevel:0,plugin:a(this).data("plugin")})}),a("#db-homeSetup").click(function(){var b=a(this);b.hasClass("btn-primary")?(b.removeClass("btn-primary").addClass("btn-default"),a(".home-block-remove").remove()):(b.removeClass("btn-default").addClass("btn-primary"),a(".home-block.home-bookmark").append('<div class="home-block-remove" title="Remove this bookmark"><span class="block-remove">&times;</span></div>'))});var j=a("#database-entries");j.on("click","li",function(b){var c="",d="",e=a(this);if(a(b.target).hasClass("db-action"))b.preventDefault(),c="spotify-track"===e.data("type")?e.data("plid")+"-"+e.data("path"):e.data("path"),GUI.DBentry[0]=c;else if(a("li.active","#database-entries").removeClass("active"),e.addClass("active"),e.hasClass("db-folder")){if(c=e.data("path"),e.hasClass("db-album"))""!==c?getDB({path:c,uplevel:0,browsemode:"album"}):(c=GUI.currentDBpath[GUI.currentDBpos[10]-1],getDB({path:c,uplevel:0,browsemode:"albumfilter"}));else if(e.hasClass("db-artist"))getDB({path:c,uplevel:0,browsemode:"artist"});else if(e.hasClass("db-composer"))getDB({path:c,uplevel:0,browsemode:"composer"});else if(e.hasClass("db-genre"))getDB({path:c,uplevel:0,browsemode:"genre"});else if(e.hasClass("db-spotify"))c=GUI.currentpath+"/"+e.find("span").text(),getDB({path:c,plugin:"Spotify",args:e.data("path").toString(),querytype:"tracks"}),GUI.plugin="Spotify";else if(e.hasClass("db-dirble")){c=GUI.currentpath+"/"+e.find("span").text();var f=e.hasClass("db-dirble-child")?"stations":"childs";getDB({path:c,plugin:"Dirble",querytype:f,args:e.data("path")}),GUI.plugin="Dirble"}else e.hasClass("db-snapcast")?(c=GUI.currentpath+"/"+e.find("span").text(),getDB({path:c,plugin:"Snapcast"}),GUI.plugin="Snapcast"):e.hasClass("db-jamendo")||(d=e.data("browsemode"),getDB({path:c,uplevel:0,browsemode:d}));var g=e.attr("id");g=g.replace("db-",""),GUI.currentDBpos[GUI.currentDBpos[10]]=g,GUI.currentDBpath[GUI.currentDBpos[10]]=c,++GUI.currentDBpos[10]}else e.hasClass("db-webradio-add")&&a("#modal-webradio-add").modal()}),j.on("dblclick","li",function(b){var c=a(this);if(!a(b.target).hasClass("db-action")){a("li.active","#database-entries").removeClass("active"),c.addClass("active");var d=c.data("path");c.hasClass("db-spotify")?(d=c.attr("data-plid")+"-"+c.attr("data-path"),getDB({cmd:"spaddplay",path:d,querytype:"spotify-track"})):c.hasClass("db-snapcast")?a.ajax({url:"/command/?switchplayer=Snapcast&host="+d,cache:!1}):(d=c.hasClass("db-dirble")?d.split(" | ")[1]:d,getDB({cmd:"addplay",path:d}))}}),a("#db-level-up").click(function(){--GUI.currentDBpos[10];var a=GUI.currentpath;if(0===GUI.currentDBpos[10])a="";else if("file"===GUI.browsemode){var b=a.lastIndexOf("/");a=-1!==b?a.slice(0,b):""}else"album"===GUI.browsemode?(a=GUI.currentDBpath[GUI.currentDBpos[10]-1],""===a?a="Albums":GUI.browsemode="artist"):"artist"===GUI.browsemode?(a=GUI.currentDBpath[GUI.currentDBpos[10]-1],""===a?a="Artists":GUI.browsemode="genre"):"composer"===GUI.browsemode?(a=GUI.currentDBpath[GUI.currentDBpos[10]-1],""===a?a="Composer":GUI.browsemode="artist"):"genre"===GUI.browsemode?a="Genres":"albumfilter"===GUI.browsemode&&(GUI.browsemode="artist",a=GUI.currentDBpath[GUI.currentDBpos[10]-1]);getDB({browsemode:GUI.browsemode,path:a,plugin:GUI.plugin,uplevel:1}),GUI.plugin=""}),a("#db-search-results").click(function(){a(this).addClass("hide"),a("#db-level-up").removeClass("hide"),getDB({path:GUI.currentpath})}),a("a",".context-menu").click(function(){var b=a(this).data("cmd"),c=a(this).data("type"),d=GUI.DBentry[0];switch(GUI.DBentry[0]="",b){case"pl-add":sendCmd('load "'+d+'"');break;case"pl-replace":sendCmd("clear"),sendCmd('load "'+d+'"');break;case"pl-addreplaceplay":sendCmd("clear"),sendCmd('load "'+d+'"'),sendCmd("play");break;case"pl-rename":a("#modal-pl-rename").modal(),a("#pl-rename-oldname").text(d);break;case"pl-rm":a.ajax({url:"/command/?cmd=rm%20%22"+d+"%22",success:function(a){getPlaylists(a)},cache:!1});break;case"pl-ashuffle":a.post("/db/?cmd=pl-ashuffle",{playlist:d}),a("#random").attr("data-cmd","pl-ashuffle-stop"),a("#random").attr("title","Stop randomly adding songs"),a("#random").addClass("btn-primary");break;case"wradd":d=d.split(" | ")[1],getDB({cmd:"add",path:d});break;case"wraddplay":d=d.split(" | ")[1],getDB({cmd:"addplay",path:d});break;case"wraddreplaceplay":d=d.split(" | ")[1],getDB({cmd:"addreplaceplay",path:d});break;case"wredit":a("#modal-webradio-edit").modal(),a.post("/db/?cmd=readradio",{filename:d},function(b){var c=a("#webradio-edit-name");c.val(b.name),c.data("file-name",b.name),a("#webradio-edit-url").val(b.url)},"json");break;case"wrdelete":a("#modal-webradio-delete").modal(),a("#webradio-delete-name").text(d.replace("Webradio/",""));break;case"wrsave":var e=d.split(" | ");a.post("/db/?cmd=addradio",{"radio[label]":e[0],"radio[url]":e[1]});break;default:getDB({cmd:b,path:d,browsemode:GUI.browsemode,querytype:c})}}),a("#webradio-add-button").click(function(){var b=a("#webradio-add-name").val(),c=a("#webradio-add-url").val();""===b||""===c?renderMSG([{title:"Missing fields",text:"Please fill both fields to continue",icon:"fa fa-warning"}]):(a.post("/db/?cmd=addradio",{"radio[label]":b,"radio[url]":c},function(a){},"json"),a("#modal-webradio-add").modal("hide"),a("#webradio-add-name").val(""),a("#webradio-add-url").val(""))}),a("#webradio-edit-button").click(function(){var b=a("#webradio-edit-name");a.post("/db/?cmd=editradio",{"radio[newlabel]":b.val(),"radio[label]":b.data("file-name"),"radio[url]":a("#webradio-edit-url").val()},function(a){},"json")}),a("#webradio-delete-button").click(function(){var b=a("#webradio-delete-name").text();a.post("/db/?cmd=deleteradio",{"radio[label]":b},function(a){},"json")}),a("#db-firstPage").click(function(){a.scrollTo(0,500)}),a("#db-prevPage").click(function(){var b="-="+a(window).height()+"px";a.scrollTo(b,500)}),a("#db-nextPage").click(function(){var b="+="+a(window).height()+"px";a.scrollTo(b,500)}),a("#db-lastPage").click(function(){a.scrollTo("100%",500)}),a("#pl-firstPage").click(function(){a.scrollTo(0,500)}),a("#pl-prevPage").click(function(){var b=a(window).scrollTop(),c=b-a(window).height();a.scrollTo(c,500)}),a("#pl-nextPage").click(function(){var b=a(window).scrollTop(),c=b+a(window).height();a.scrollTo(c,500)}),a("#pl-lastPage").click(function(){a.scrollTo("100%",500)});var k=document.location.toString();k.match("#")&&a('#menu-bottom a[href="/#'+k.split("#")[1]+'"]').tab("show"),a("#menu-bottom a").on("shown",function(a){history.pushState?history.pushState(null,null,a.target.hash):window.location.hash=a.target.hash}).on("click",function(){a("#overlay-social").hasClass("open")&&a(".overlay-close").trigger("click")}),a(".ttip").length&&a(".ttip").tooltip(),FastClick.attach(document.body),a("#syscmd-poweroff").click(function(){a.post("/settings/",{syscmd:"poweroff"}),toggleLoader()}),a("#syscmd-reboot").click(function(){a.post("/settings/",{syscmd:"reboot"}),toggleLoader()}),a("#syscmd-display_off").click(function(){a.post("/settings/",{syscmd:"display_off"})}),overlayTrigger("#overlay-social"),overlayTrigger("#overlay-playsource"),a("#playsource-mpd").click(function(){a(this).hasClass("inactive")&&(GUI.forceGUIupdate=!0,a.ajax({url:"/command/?switchplayer=MPD",cache:!1}),a("#overlay-playsource-close").trigger("click"))}),a("#playsource-snapcast").click(function(){a(this).hasClass("inactive")&&(GUI.forceGUIupdate=!0,a.ajax({url:"/command/?switchplayer=Snapcast",cache:!1}),a("#overlay-playsource-close").trigger("click"))}),a("#playsource-spotify").click(function(){a(this).hasClass("inactive")&&("1"===GUI.libraryhome.Spotify?(GUI.forceGUIupdate=!0,a.ajax({url:"/command/?switchplayer=Spotify",cache:!1}),a("#overlay-playsource-close").trigger("click")):new PNotify({title:"Spotify not enabled",text:"Enable and configure it under the Settings screen",icon:"fa fa-exclamation-circle"}))}),"localhost"==document.location.hostname&&a(".osk-trigger").onScreenKeyboard({draggable:!0})}):(jQuery(document).ready(function(a){"use strict";if(GUI.mode=checkWebSocket(),playbackChannel(),PNotify.prototype.options.styling="fontawesome",PNotify.prototype.options.stack.dir1="up",PNotify.prototype.options.stack.dir2="left",PNotify.prototype.options.stack.firstpos1=90,PNotify.prototype.options.stack.firstpos2=50,PNotify.prototype.options.stack.spacing1=10,PNotify.prototype.options.stack.spacing2=10,notifyChannel(),a(".btn-cmd").click(function(){commandButton(a(this))}),a("#syscmd-poweroff").click(function(){a.post("/settings/",{syscmd:"poweroff"}),toggleLoader()}),a("#syscmd-reboot").click(function(){a.post("/settings/",{syscmd:"reboot"}),toggleLoader()}),a("#syscmd-display_off").click(function(){a.post("/settings/",{syscmd:"display_off"})}),a(".selectpicker").selectpicker(),a("#section-sources").length&&("nfs"===a("#mount-type").val()&&a("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide"),a("#mount-type").change(function(){"cifs"===a(this).val()||"osx"===a(this).val()?a("#mount-cifs").removeClass("disabled").children(".disabler").addClass("hide"):a("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide")}),a("#nas-guest").change(function(){a(this).prop("checked")?a("#mount-auth").addClass("disabled").children(".disabler").removeClass("hide"):a("#mount-auth").removeClass("disabled").children(".disabler").addClass("hide")}),a("#nas-advanced").change(function(){a(this).prop("checked")?a("#mount-advanced-config").removeClass("hide"):a("#mount-advanced-config").addClass("hide")}),a("#show-mount-advanced-config").click(function(b){b.preventDefault(),a(this).hasClass("active")?(a("#mount-advanced-config").toggleClass("hide"),a(this).removeClass("active"),a(this).find("i").removeClass("fa fa-minus-circle").addClass("fa fa-plus-circle"),a(this).find("span").html("show advanced options")):(a("#mount-advanced-config").toggleClass("hide"),a(this).addClass("active"),a(this).find("i").removeClass("fa fa-plus-circle").addClass("fa fa-minus-circle"),a(this).find("span").html("hide advanced options"))}),a("#usb-mount-list a").click(function(){var b=a(this).data("mount");a("#usb-umount-name").html(b),a("#usb-umount").val(b)})),a("#section-settings").length&&(a("#airplay").change(function(){a(this).prop("checked")?(a("#airplayName").removeClass("hide"),a("#airplayBox").addClass("boxed-group")):(a("#airplayName").addClass("hide"),a("#airplayBox").removeClass("boxed-group"))}),a("#scrobbling-lastfm").change(function(){a(this).prop("checked")?(a("#lastfmAuth").removeClass("hide"),a("#lastfmBox").addClass("boxed-group")):(a("#lastfmAuth").addClass("hide"),a("#lastfmBox").removeClass("boxed-group"))}),a("#proxy").change(function(){a(this).prop("checked")?(a("#proxyAuth").removeClass("hide"),a("#proxyBox").addClass("boxed-group")):(a("#proxyAuth").addClass("hide"),a("#proxyBox").removeClass("boxed-group"))}),a("#dlna").change(function(){a(this).prop("checked")?(a("#dlnaName").removeClass("hide"),a("#dlnaBox").addClass("boxed-group")):(a("#dlnaName").addClass("hide"),a("#dlnaBox").removeClass("boxed-group"))}),a("#local_browser").change(function(){a(this).prop("checked")?(a("#local_browserName").removeClass("hide"),a("#local_browserBox").addClass("boxed-group")):(a("#local_browserName").addClass("hide"),a("#local_browserBox").removeClass("boxed-group"))}),a("#dlnaTidal").change(function(){a(this).prop("checked")?(a("#dlnaTidalName").removeClass("hide"),a("#dlnaTidalBox").addClass("boxed-group")):(a("#dlnaTidalName").addClass("hide"),a("#dlnaTidalBox").removeClass("boxed-group"))}),a("#dlnaGoogle").change(function(){a(this).prop("checked")?(a("#dlnaGoogleName").removeClass("hide"),a("#dlnaGoogleBox").addClass("boxed-group")):(a("#dlnaGoogleName").addClass("hide"),a("#dlnaGoogleBox").removeClass("boxed-group"))}),a("#dlnaQobuz").change(function(){a(this).prop("checked")?(a("#dlnaQobuzName").removeClass("hide"),a("#dlnaQobuzBox").addClass("boxed-group")):(a("#dlnaQobuzName").addClass("hide"),a("#dlnaQobuzBox").removeClass("boxed-group"))}),a("#spotify").change(function(){a(this).prop("checked")?(a("#spotifyAuth").removeClass("hide"),a("#spotifyBox").addClass("boxed-group")):(a("#spotifyAuth").addClass("hide"),a("#spotifyBox").removeClass("boxed-group"))}),a("#samba").change(function(){a(this).prop("checked")?(a("#sambaAuth").removeClass("hide"),a("#sambaBox").addClass("boxed-group")):(a("#sambaAuth").addClass("hide"),a("#sambaBox").removeClass("boxed-group"))}),a("#bluetooth").change(function(){a(this).prop("checked")?(a("#bluetoothAuth").removeClass("hide"),a("#bluetoothBox").addClass("boxed-group")):(a("#bluetoothAuth").addClass("hide"),a("#bluetoothBox").removeClass("boxed-group"))}),a(".btn-file :file").on("fileselect",function(b,c,d){var e=a(this).parents(".input-group").find(":text");e.length?e.val(d):d&&(console.log("Selected file: ",d),d.indexOf("backup_")>-1&&d.indexOf(".tar.gz")>-1?(a("#backup-file").html(' <i class="fa fa-check dx green"></i> '+d),a("#btn-backup-upload").prop("disabled",!1)):(a("#backup-file").html(' <i class="fa fa-times dx red"></i> not a valid backup file'),a("#btn-backup-upload").prop("disabled",!0)))})),a("#section-network").length){var b=a("#network-manual-config");"0"===a("#dhcp").val()&&b.removeClass("hide"),a("#dhcp").change(function(){"0"===a(this).val()?b.removeClass("hide"):b.addClass("hide")});var c=a("#wifi-security-key");"open"!==a("#wifi-security").val()&&c.removeClass("hide"),a("#wifi-security").change(function(){"open"!==a(this).val()?c.removeClass("hide"):c.addClass("hide")}),a("#wifiNetworks").length&&(wlansChannel(),nicsChannel()),a("#wifiProfiles").change(function(){a(this).prop("checked")?a("#wifiProfilesBox").addClass("hide"):a("#wifiProfilesBox").removeClass("hide")})}if(a("#section-accesspoint").length&&(a("#accesspoint").change(function(){a(this).prop("checked")?(a("#accesspointSettings").removeClass("hide"),a("#accesspointBox").addClass("boxed-group")):(a("#accesspointSettings").addClass("hide"),a("#accesspointBox").removeClass("boxed-group"))}),a("#ip-address").change(function(){var b=a("#ip-address").val().split(".");b[3]++,a("#dhcp-range").val(b.join(".")+","+b[0]+"."+b[1]+"."+b[2]+".254,24h"),b[3]=255,a("#broadcast").val(b.join(".")),a("#dhcp-option-dns").val(a("#ip-address").val()),a("#dhcp-option-router").val(a("#ip-address").val())})),a("#section-mpd").length&&(a("#audio-output-interface").change(function(){renderMSG([{title:"Switching audio output",text:"Please wait for the config update...",icon:"fa fa-cog fa-spin",delay:5e3}]);var b=a(this).val();a.ajax({type:"POST",url:"/mpd/",data:{ao:b},cache:!1})}),a(".manual-edit-confirm").find(".btn-primary").click(function(){a("#mpdconf_editor").removeClass("hide"),a("#manual-edit-warning").addClass("hide")})),a("#section-debug").length){ZeroClipboard.config({swfPath:"/assets/js/vendor/ZeroClipboard.swf"});var d=new ZeroClipboard(document.getElementById("copy-to-clipboard"));d.on("ready",function(a){d.on("aftercopy",function(a){new PNotify({title:"Copied to clipboard",text:"The debug output was copied successfully in your clipboard.",icon:"fa fa-check"})})})}"localhost"==document.location.hostname&&a(".osk-trigger").onScreenKeyboard({draggable:!0})}),$(document).on("change",".btn-file :file",function(){var a=$(this),b=a.get(0).files?a.get(0).files.length:1,c=a.val().replace(/\\/g,"/").replace(/.*\//,"");a.trigger("fileselect",[b,c])}));
>>>>>>> 0.5b-snapcast
